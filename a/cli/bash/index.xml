<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>progrhyme's Tech Notes – Bash</title><link>https://progrhy.me/tech-notes/a/cli/bash/</link><description>Recent content in Bash on progrhyme's Tech Notes</description><generator>Hugo -- gohugo.io</generator><language>ja</language><lastBuildDate>Tue, 28 Apr 2020 09:14:42 +0900</lastBuildDate><atom:link href="https://progrhy.me/tech-notes/a/cli/bash/index.xml" rel="self" type="application/rss+xml"/><item><title>A: Cookbooks</title><link>https://progrhy.me/tech-notes/a/cli/bash/cookbook/</link><pubDate>Tue, 28 Apr 2020 12:04:10 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/cli/bash/cookbook/</guid><description>
&lt;p>関連ページ:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://progrhy.me/tech-notes/a/cli/shell-script/">シェルスクリプト&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>NOTE:&lt;/p>
&lt;ul>
&lt;li>このページに書いているが、実はPOSIX対応の機能もあるかもしれない。&lt;/li>
&lt;/ul>
&lt;h2 id="複数行のコメントアウト">複数行のコメントアウト&lt;/h2>
&lt;p>&lt;code>:&lt;/code> とヒアドキュメントを組み合わせる。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">: &amp;lt;&amp;lt; &lt;span style="color:#4e9a06">&amp;#34;__EOCOMMENT__&amp;#34;&lt;/span>
コメントアウトしたいコード
__EOCOMMENT__
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://qiita.com/imura81gt/items/a2998147bd7ae8056b26" title="bashで複数行コメントアウトする方法 - Qiita">bashで複数行コメントアウトする方法 - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="論理演算">論理演算&lt;/h2>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#ce5c00;font-weight:bold">((&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> &amp;gt; 1&lt;span style="color:#ce5c00;font-weight:bold">))&lt;/span> &lt;span style="color:#8f5902;font-style:italic"># $? =&amp;gt; 0&lt;/span>
&lt;span style="color:#ce5c00;font-weight:bold">((&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &amp;gt; 1&lt;span style="color:#ce5c00;font-weight:bold">))&lt;/span> &lt;span style="color:#8f5902;font-style:italic"># $? =&amp;gt; 1&lt;/span>
&lt;span style="color:#ce5c00;font-weight:bold">((&lt;/span>&lt;span style="color:#204a87;font-weight:bold">$(&lt;/span>seq &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">3&lt;/span> &lt;span style="color:#000;font-weight:bold">|&lt;/span> wc -w&lt;span style="color:#204a87;font-weight:bold">)&lt;/span> &amp;gt; 2&lt;span style="color:#ce5c00;font-weight:bold">))&lt;/span> &lt;span style="color:#8f5902;font-style:italic"># $? =&amp;gt; 0&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">if&lt;/span> true&lt;span style="color:#000;font-weight:bold">;&lt;/span> &lt;span style="color:#204a87;font-weight:bold">then&lt;/span> &lt;span style="color:#204a87">echo&lt;/span> ok&lt;span style="color:#000;font-weight:bold">;&lt;/span> &lt;span style="color:#204a87;font-weight:bold">fi&lt;/span> &lt;span style="color:#8f5902;font-style:italic">#=&amp;gt; ok&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="数値の操作">数値の操作&lt;/h2>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#000">i&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>
&lt;span style="color:#204a87">echo&lt;/span> &lt;span style="color:#204a87;font-weight:bold">$((&lt;/span>i++&lt;span style="color:#204a87;font-weight:bold">))&lt;/span> &lt;span style="color:#8f5902;font-style:italic">#=&amp;gt; 0&lt;/span>
&lt;span style="color:#204a87">echo&lt;/span> &lt;span style="color:#204a87;font-weight:bold">$((&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">++&lt;/span>i&lt;span style="color:#204a87;font-weight:bold">))&lt;/span> &lt;span style="color:#8f5902;font-style:italic">#=&amp;gt; 2&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="連番によるループ">連番によるループ&lt;/h2>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ &lt;span style="color:#000">n&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>
$ &lt;span style="color:#204a87;font-weight:bold">for&lt;/span> i in &lt;span style="color:#204a87;font-weight:bold">$(&lt;/span>seq &lt;span style="color:#000">$n&lt;/span> &lt;span style="color:#204a87;font-weight:bold">$((&lt;/span>n &lt;span style="color:#ce5c00;font-weight:bold">+&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#204a87;font-weight:bold">)))&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span> &lt;span style="color:#204a87;font-weight:bold">do&lt;/span> &lt;span style="color:#204a87">echo&lt;/span> &lt;span style="color:#000">$i&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span> &lt;span style="color:#204a87;font-weight:bold">done&lt;/span>
&lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>
&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>
&lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="多重ループとbreak-continue">多重ループとbreak, continue&lt;/h2>
&lt;p>&lt;code>break 2&lt;/code> や &lt;code>continue 2&lt;/code> のように後ろに数字を与えることで、上の階層のループを抜けられるようだ。&lt;/p>
&lt;p>Example:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">&lt;span style="color:#204a87;font-weight:bold">for&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">((&lt;/span>&lt;span style="color:#000">i&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>1&lt;span style="color:#000;font-weight:bold">;&lt;/span> i &amp;lt;&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> 4&lt;span style="color:#000;font-weight:bold">;&lt;/span> i++&lt;span style="color:#ce5c00;font-weight:bold">))&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span> &lt;span style="color:#204a87;font-weight:bold">do&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">for&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">((&lt;/span>&lt;span style="color:#000">j&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>1&lt;span style="color:#000;font-weight:bold">;&lt;/span> j &amp;lt;&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> 3&lt;span style="color:#000;font-weight:bold">;&lt;/span> j++&lt;span style="color:#ce5c00;font-weight:bold">))&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span> &lt;span style="color:#204a87;font-weight:bold">do&lt;/span>
&lt;span style="color:#204a87">echo&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;(i, j) = (&lt;/span>&lt;span style="color:#000">$i&lt;/span>&lt;span style="color:#4e9a06">, &lt;/span>&lt;span style="color:#000">$j&lt;/span>&lt;span style="color:#4e9a06">)&amp;#34;&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">((&lt;/span>i &amp;gt; 2&lt;span style="color:#ce5c00;font-weight:bold">))&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span> &lt;span style="color:#204a87;font-weight:bold">then&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">((&lt;/span>&lt;span style="color:#000">j&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">==&lt;/span> 2&lt;span style="color:#ce5c00;font-weight:bold">))&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span> &lt;span style="color:#204a87;font-weight:bold">then&lt;/span>
&lt;span style="color:#204a87">echo&lt;/span> End of loop
&lt;span style="color:#204a87">break&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">fi&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">elif&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">((&lt;/span>i &amp;gt; &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#000">j&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">==&lt;/span> 2&lt;span style="color:#ce5c00;font-weight:bold">))&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span> &lt;span style="color:#204a87;font-weight:bold">then&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">continue&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">fi&lt;/span>
&lt;span style="color:#204a87">echo&lt;/span> blah blah
&lt;span style="color:#204a87;font-weight:bold">done&lt;/span>
&lt;span style="color:#204a87">echo&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;[&lt;/span>&lt;span style="color:#000">$i&lt;/span>&lt;span style="color:#4e9a06">] end&amp;#34;&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">done&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>実行結果:&lt;/p>
&lt;pre>&lt;code>(i, j) = (1, 1)
blah blah
(i, j) = (1, 2)
blah blah
(i, j) = (1, 3)
blah blah
[1] end
(i, j) = (2, 1)
blah blah
(i, j) = (2, 2)
(i, j) = (3, 1)
blah blah
(i, j) = (3, 2)
End of loop
&lt;/code>&lt;/pre>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://ameblo.jp/dagyah/entry-12341581495.html">bash のbreak、continue、return、exit | 敗走王のブログ&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="文字列操作">文字列操作&lt;/h2>
&lt;h3 id="部分文字列の削除">部分文字列の削除&lt;/h3>
&lt;p>以下、 &lt;a href="http://iishikawa.s371.xrea.com/note/bash-script.html#idm2045339272">Bash scripting&lt;/a> より。&lt;/p>
&lt;ul>
&lt;li>&lt;code>${var%pattern}&lt;/code> … 後方からパターンの最短マッチを削除&lt;/li>
&lt;li>&lt;code>${var%%pattern}&lt;/code> … 後方からパターンの最長マッチを削除&lt;/li>
&lt;li>&lt;code>${var#pattern}&lt;/code> … 前方からパターンの最短マッチを削除&lt;/li>
&lt;li>&lt;code>${var##pattern}&lt;/code> … 前方からパターンの最長マッチを削除&lt;/li>
&lt;/ul>
&lt;p>パスからディレクトリ名やファイル名を取り出すのによく使う。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#000">fullpath&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>/a/b/c.txt
&lt;span style="color:#204a87">echo&lt;/span> &lt;span style="color:#4e9a06">${&lt;/span>&lt;span style="color:#000">fullpath&lt;/span>&lt;span style="color:#000;font-weight:bold">##*/&lt;/span>&lt;span style="color:#4e9a06">}&lt;/span> &lt;span style="color:#8f5902;font-style:italic"># c.txt&lt;/span>
&lt;span style="color:#204a87">echo&lt;/span> &lt;span style="color:#4e9a06">${&lt;/span>&lt;span style="color:#000">fullpath&lt;/span>&lt;span style="color:#000;font-weight:bold">%/*&lt;/span>&lt;span style="color:#4e9a06">}&lt;/span> &lt;span style="color:#8f5902;font-style:italic"># /a/b&lt;/span>
&lt;span style="color:#000">filename&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>d.e.txt
&lt;span style="color:#204a87">echo&lt;/span> &lt;span style="color:#4e9a06">${&lt;/span>&lt;span style="color:#000">filename&lt;/span>&lt;span style="color:#000;font-weight:bold">%.*&lt;/span>&lt;span style="color:#4e9a06">}&lt;/span> &lt;span style="color:#8f5902;font-style:italic"># d.e&lt;/span>
&lt;span style="color:#204a87">echo&lt;/span> &lt;span style="color:#4e9a06">${&lt;/span>&lt;span style="color:#000">filename&lt;/span>&lt;span style="color:#000;font-weight:bold">##*.&lt;/span>&lt;span style="color:#4e9a06">}&lt;/span> &lt;span style="color:#8f5902;font-style:italic"># txt&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>たぶん、Bash に限らず POSIX で使える。&lt;br>
下に載ってる。&lt;/p>
&lt;p>&lt;a href="http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_06_02">http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_06_02&lt;/a>&lt;/p>
&lt;h3 id="文字列の部分切り出し">文字列の部分切り出し&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ &lt;span style="color:#204a87">echo&lt;/span> &lt;span style="color:#000">$str&lt;/span>
&lt;span style="color:#0000cf;font-weight:bold">1234567890&lt;/span>
$ &lt;span style="color:#204a87">echo&lt;/span> &lt;span style="color:#4e9a06">${&lt;/span>&lt;span style="color:#000">str&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#000">3&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#000">4&lt;/span>&lt;span style="color:#4e9a06">}&lt;/span>
&lt;span style="color:#0000cf;font-weight:bold">4567&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://kiririmode.hatenablog.jp/entry/20170913/1505228400">シェルスクリプトで部分文字列を切り出す - 理系学生日記&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="文字列を部分的に置換">文字列を部分的に置換&lt;/h3>
&lt;ul>
&lt;li>&lt;code>${var/x/y}&lt;/code> &amp;hellip; &lt;code>$var&lt;/code> 文字列の &lt;code>x&lt;/code> を &lt;code>y&lt;/code> に置換（1回のみ）&lt;/li>
&lt;li>&lt;code>${var//x/y}&lt;/code> &amp;hellip; &lt;code>$var&lt;/code> 文字列の &lt;code>x&lt;/code> を &lt;code>y&lt;/code> に置換（全てマッチ）&lt;/li>
&lt;/ul>
&lt;p>参考: &lt;a href="http://www.koikikukan.com/archives/2019/05/09-235555.php">bashの変数をsplitして配列を作る方法: 小粋空間&lt;/a>&lt;/p></description></item></channel></rss>