<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>progrhyme's Tech Notes – progrhyme's Tech Notes</title><link>https://progrhy.me/tech-notes/a/</link><description>Recent content on progrhyme's Tech Notes</description><generator>Hugo -- gohugo.io</generator><language>ja</language><atom:link href="https://progrhy.me/tech-notes/a/index.xml" rel="self" type="application/rss+xml"/><item><title>A: Concept</title><link>https://progrhy.me/tech-notes/a/software/k8s/concept/</link><pubDate>Mon, 27 Apr 2020 10:53:19 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/software/k8s/concept/</guid><description>
&lt;h2 id="documentation">Documentation&lt;/h2>
&lt;p>&lt;a href="https://kubernetes.io/docs/concepts/">https://kubernetes.io/docs/concepts/&lt;/a>&lt;/p>
&lt;h2 id="overview">Overview&lt;/h2>
&lt;ul>
&lt;li>Kubernetes Master
&lt;ul>
&lt;li>クラスタ内に１つ存在するマスターノード。ノード上で、&lt;a href="https://kubernetes.io/docs/reference/generated/kube-apiserver/">kube-apiserver&lt;/a>, &lt;a href="https://kubernetes.io/docs/reference/generated/kube-controller-manager/">kube-controller-manager&lt;/a>, &lt;a href="https://kubernetes.io/docs/reference/generated/kube-scheduler/">kube-scheduler&lt;/a>の3プロセスが動作する。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>マスター以外のノードで動くプロセス:
&lt;ul>
&lt;li>&lt;a href="https://kubernetes.io/docs/reference/generated/kubelet/">kubelet&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://kubernetes.io/docs/reference/generated/kube-proxy/">kube-proxy&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>基本的なオブジェクト:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://kubernetes.io/docs/concepts/workloads/pods/pod-overview/">Pod&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://kubernetes.io/docs/concepts/services-networking/service/">Service&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://kubernetes.io/docs/concepts/storage/volumes/">Volume&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/">Namespace&lt;/a>
&lt;ul>
&lt;li>Kubernetesでは、複数の仮想的なクラスタを同じ物理クラスタ上に構築することができる。この仮想クラスタのことを &lt;strong>Namespace&lt;/strong> と呼ぶ。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>より高次の概念として &lt;strong>Controller&lt;/strong> と呼ばれるものがある。&lt;br>
これは基本オブジェクト上に構築され、以下のような便利な機能を提供する:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/">ReplicaSet&lt;/a> &amp;hellip; &lt;a href="https://kubernetes.io/docs/concepts/workloads/controllers/replicationcontroller/">Replication Controller&lt;/a>の後継。&lt;/li>
&lt;li>&lt;a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">Deployment&lt;/a> &amp;hellip; PodやReplicaSetの状態を宣言的に記述することを可能にする。&lt;/li>
&lt;li>&lt;a href="https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/">StatefulSet&lt;/a> &amp;hellip; v1.8でbeta. Deployment同様Podを管理するが、それぞれのPodを異なる個体と認識する。&lt;/li>
&lt;li>&lt;a href="https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/">DaemonSet&lt;/a> &amp;hellip; ノード上でPodのコピーを動かす。典型的なユースケースとしては、cephやfluentd, collectdなどが挙げられる。&lt;/li>
&lt;li>&lt;a href="https://kubernetes.io/docs/concepts/workloads/controllers/jobs-run-to-completion/">Job&lt;/a> &amp;hellip; Podを実行し、正常に完了するまでをトラッキングする。定められた回数、正常に完了したら、Jobも完了となる。&lt;/li>
&lt;/ul>
&lt;h2 id="components">Components&lt;/h2>
&lt;p>&lt;a href="https://kubernetes.io/docs/concepts/overview/components/">https://kubernetes.io/docs/concepts/overview/components/&lt;/a>&lt;/p>
&lt;h3 id="master-components">Master Components&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://kubernetes.io/docs/reference/generated/kube-apiserver/">kube-apiserver&lt;/a>
&lt;ul>
&lt;li>Kubernetesを制御するフロントAPI. 水平スケール可能。参考: &lt;a href="https://kubernetes.io/docs/admin/high-availability/">Building High-Availability Clusters | Kubernetes&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/">etcd&lt;/a> &amp;hellip; クラスタの管理データが保存されるので、バックアップすべし。&lt;/li>
&lt;li>&lt;a href="https://kubernetes.io/docs/reference/generated/kube-controller-manager/">kube-controller-manager&lt;/a>
&lt;ul>
&lt;li>Controllerをバックグラウンドのスレッドで動かす。&lt;/li>
&lt;li>個々のControllerは論理的には独立した存在だが、複雑性を避けるため同一のバイナリで単一プロセスとして動作している。&lt;/li>
&lt;li>以下のControllerが含まれる:
&lt;ul>
&lt;li>Node Controller&lt;/li>
&lt;li>Replication Controller&lt;/li>
&lt;li>Endpoints Controller&lt;/li>
&lt;li>Service Account &amp;amp; Token Controller&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>cloud-controller-manager &amp;hellip; v1.6でalpha. クラウド基盤とやりとりするControllerを動かす。&lt;/li>
&lt;li>&lt;a href="https://kubernetes.io/docs/reference/generated/kube-scheduler/">kube-scheduler&lt;/a> &amp;hellip; 生成されるPodを監視し、Podを動作させるノードを決定する。&lt;/li>
&lt;li>addons &amp;hellip; クラスタの機能を提供するPod群。これらのPodは &lt;code>kube-system&lt;/code> という &lt;strong>Namespace&lt;/strong> に作られる。
&lt;ul>
&lt;li>&lt;a href="https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/">DNS&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://kubernetes.io/docs/tasks/access-application-cluster/web-ui-dashboard/">Web UI (Dashboard)&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://kubernetes.io/docs/tasks/debug-application-cluster/resource-usage-monitoring/">Container Resource Monitoring&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://kubernetes.io/docs/concepts/cluster-administration/logging/">Cluster-level Logging&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="node-components">Node Components&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://kubernetes.io/docs/reference/generated/kubelet/">kubelet&lt;/a> &amp;hellip; マスターと通信するエージェントプロセス。&lt;/li>
&lt;li>&lt;a href="https://kubernetes.io/docs/reference/generated/kube-proxy/">kube-proxy&lt;/a> &amp;hellip; ノード上でKubernetes APIによって定義されたサービスを媒介するネットワークプロキシ。&lt;/li>
&lt;li>docker, rkt &amp;hellip; コンテナランタイム&lt;/li>
&lt;li>supervisord &amp;hellip; ノード上でdockerやkubeletを動かし続ける。&lt;/li>
&lt;li>fluentd &amp;hellip; cluster-level loggingを実現する。&lt;/li>
&lt;/ul>
&lt;h2 id="pods">Pods&lt;/h2>
&lt;p>Podが起動できない理由:&lt;/p>
&lt;ul>
&lt;li>OutOfMemory, OutOfCpu &amp;hellip; Nodeのリソースが足りない&lt;/li>
&lt;/ul>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://kubernetes.io/ja/docs/concepts/configuration/assign-pod-node/">Node上へのPodのスケジューリング - Kubernetes&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="podの終了">Podの終了&lt;/h3>
&lt;p>&lt;a href="https://kubernetes.io/docs/concepts/workloads/pods/pod/#termination-of-pods">https://kubernetes.io/docs/concepts/workloads/pods/pod/#termination-of-pods&lt;/a>&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://qiita.com/superbrothers/items/3ac78daba3560ea406b2">Kubernetes: 詳解 Pods の終了 - Qiita&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://tech-lab.sios.jp/archives/18730">KubernetesでRollingUpdateするためのPodの安全な終了 | SIOS Tech. Lab&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="crashloopbackoff">CrashLoopBackOff&lt;/h3>
&lt;p>発生条件:&lt;/p>
&lt;ul>
&lt;li>memory limits以上を使おうとしてOOMで殺され、繰り返し再起動されるとき
&lt;ul>
&lt;li>再起動間隔はexponential backoffで延びる&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://qiita.com/sheepland/items/eb0e4c65aaae70ec4e2f">KubernetesのResource RequestsとResource Limitsについて - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="services">Services&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://kubernetes.io/docs/concepts/services-networking/service/">https://kubernetes.io/docs/concepts/services-networking/service/&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/concepts/service">https://cloud.google.com/kubernetes-engine/docs/concepts/service&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>Kubernetesクラスタ内では、複数のPodを束ねてServiceにしている。
Serviceを使用すると、メンバーPodのIPアドレスが変更されても、Serviceが存続している間に固定のIPアドレスを取得できる。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#label-selectors">Label Selector&lt;/a> &amp;hellip; サービスを識別するためのラベルとそのセレクタ。&lt;/li>
&lt;li>&lt;strong>Endpoints&lt;/strong> API &amp;hellip; Service内のPodの変更に伴って更新される。&lt;/li>
&lt;/ul>
&lt;p>Service定義ファイルのサンプル:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-YAML" data-lang="YAML">&lt;span style="color:#204a87;font-weight:bold">kind&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>Service&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">apiVersion&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>v1&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">metadata&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>my-service&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">spec&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">selector&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">app&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>MyApp&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">ports&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">protocol&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>TCP&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">port&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">80&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">targetPort&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">9376&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>これはKubernetesクラスタ内で &lt;code>my-service&lt;/code> という名前でアクセスできる。&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/concepts/service?hl=ja">Service | Kubernetes Engine のドキュメント | Google Cloud&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://cstoku.dev/posts/2018/k8sdojo-09/">Kubernetes道場 9日目 - Serviceについて - Toku&amp;rsquo;s Blog&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="serviceのtype">Serviceのtype&lt;/h3>
&lt;p>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/concepts/service?hl=ja#types_of_services">https://cloud.google.com/kubernetes-engine/docs/concepts/service?hl=ja#types_of_services&lt;/a>&lt;/p>
&lt;ul>
&lt;li>&lt;code>ClusterIP&lt;/code> （デフォルト） &amp;hellip; クラスタ内で固定IPアドレスを獲得&lt;/li>
&lt;li>&lt;code>NodePort&lt;/code> &amp;hellip; 指定された1つ以上の &lt;code>nodePort&lt;/code> 値を利用して、ノードのIPアドレスを通じてアクセス可能になる&lt;/li>
&lt;li>&lt;code>LoadBalancer&lt;/code> &amp;hellip; ネットワークロードバランサを介したアクセスを提供&lt;/li>
&lt;li>&lt;code>ExternalName&lt;/code> &amp;hellip; See below&lt;/li>
&lt;li>&lt;code>Headless&lt;/code>&lt;/li>
&lt;/ul>
&lt;h3 id="externalname">ExternalName&lt;/h3>
&lt;p>&lt;a href="https://kubernetes.io/ja/docs/concepts/services-networking/service/#externalname">https://kubernetes.io/ja/docs/concepts/services-networking/service/#externalname&lt;/a>&lt;/p>
&lt;p>外部から参照できるDNS名を提供する。&lt;br>
この機能を使うには、GKEなどのように、KubernetesにDNSコンポーネントが導入されている必要がある。&lt;/p>
&lt;p>Example:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-YAML" data-lang="YAML">&lt;span style="color:#204a87;font-weight:bold">apiVersion&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>v1&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">kind&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>Service&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">metadata&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>my-service&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">namespace&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>prod&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">spec&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">type&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>ExternalName&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">externalName&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>my.database.example.com&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="リソース管理">リソース管理&lt;/h2>
&lt;h3 id="pod-eviction">Pod Eviction&lt;/h3>
&lt;p>Documents:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://kubernetes.io/docs/tasks/administer-cluster/out-of-resource/">https://kubernetes.io/docs/tasks/administer-cluster/out-of-resource/&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>メモ:&lt;/p>
&lt;ul>
&lt;li>ノードのメモリが不足すると、Podがevictされることがある&lt;/li>
&lt;li>メモリ使用量の大きなPodからeviction対象になる&lt;/li>
&lt;li>memoryのrequets/limitsを適切に設定しておくこと&lt;/li>
&lt;/ul>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.scsk.jp/sp/sysdig/blog/sysdig_monitor/kubernetes_pod_evicted.html">Kubernetes pod evictedとスケジューリングの問題を理解する | Sysdigブログ - コンテナ・Kubernetes環境向けセキュリティ・モニタリング プラットフォーム&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://kubernetes.io/ja/docs/concepts/architecture/nodes/">ノード - Kubernetes&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>A: Configuration</title><link>https://progrhy.me/tech-notes/a/software/k8s/config/</link><pubDate>Mon, 27 Apr 2020 10:53:22 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/software/k8s/config/</guid><description>
&lt;h2 id="best-practices">Best Practices&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://kubernetes.io/docs/concepts/configuration/overview/">Configuration Best Practices | Kubernetes&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="kubeconfig">kubeconfig&lt;/h2>
&lt;p>クラスタ認証情報を保存するYAMLファイル。&lt;br>
&lt;code>kubectl&lt;/code> の設定ファイル。&lt;br>
デフォルトのPATHは &lt;code>$HOME/.kube/config&lt;/code>&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://kubernetes.io/docs/tasks/access-application-cluster/configure-access-multiple-clusters/">Configure Access to Multiple Clusters - Kubernetes&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="container">Container&lt;/h2>
&lt;h3 id="コマンド引数の定義">コマンド/引数の定義&lt;/h3>
&lt;p>See &lt;a href="https://kubernetes.io/docs/tasks/inject-data-application/define-command-argument-container/#notes">https://kubernetes.io/docs/tasks/inject-data-application/define-command-argument-container/#notes&lt;/a>&lt;/p>
&lt;p>Example:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-YAML" data-lang="YAML">&lt;span style="color:#204a87;font-weight:bold">apiVersion&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>v1&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">kind&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>Pod&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">metadata&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>command-demo&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">labels&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">purpose&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>demonstrate-command&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">spec&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">containers&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>command-demo-container&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">image&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>debian&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">command&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;printenv&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">args&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;HOSTNAME&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;KUBERNETES_PORT&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">restartPolicy&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>OnFailure&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="livenessreadiness-probes">liveness/readiness probes&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/">Configure Liveness, Readiness and Startup Probes - Kubernetes&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>ヘルスチェック的なもの。&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://cstoku.dev/posts/2018/k8sdojo-10/">Kubernetes道場 10日目 - LivenessProbe / ReadinessProbeについて - Toku&amp;rsquo;s Blog&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="lifecycle-hooks">Lifecycle Hooks&lt;/h3>
&lt;p>&lt;a href="https://kubernetes.io/docs/concepts/containers/container-lifecycle-hooks/">https://kubernetes.io/docs/concepts/containers/container-lifecycle-hooks/&lt;/a>&lt;/p>
&lt;p>以下のフックを仕込むことで、コマンド実行などが可能。&lt;/p>
&lt;ul>
&lt;li>PostStart&lt;/li>
&lt;li>PreStop &amp;hellip; 終了直前に実行される&lt;/li>
&lt;/ul>
&lt;p>詳細な仕様はAPIリファレンスを見よ。&lt;/p>
&lt;p>設定例:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-YAML" data-lang="YAML">&lt;span style="color:#204a87;font-weight:bold">apiVersion&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>v1&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">kind&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>Pod&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">metadata&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>lifecycle-demo&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">spec&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">containers&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>lifecycle-demo-container&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">image&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>httpd&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">lifecycle&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">preStop&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">exec&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">command&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;sh&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;-c&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;sleep 2; httpd -k graceful-stop; sleep 30&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">terminationGracePeriodSeconds&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">40&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://44smkn.hatenadiary.com/entry/2018/08/01/022312">pod(Kubernetes)のlifecycle.prestopの挙動 - １クール続けるブログ&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://cstoku.dev/posts/2018/k8sdojo-06/">Kubernetes道場 6日目 - Init Container / Lifecycleについて - Toku&amp;rsquo;s Blog&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="pods">Pods&lt;/h2>
&lt;h3 id="affinity">Affinity&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://kubernetes.io/ja/docs/concepts/configuration/assign-pod-node/#affinity-%e3%81%a8-anti-affinity">Node上へのPodのスケジューリング - Kubernetes#AffinityとAnti-Affinity&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://cstoku.dev/posts/2018/k8sdojo-18/#affinity-anti-affinity">Kubernetes道場 18日目 - Affinity / Anti-Affinity / Taint / Tolerationについて - Toku&amp;rsquo;s Blog&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.1915keke.com/entry/2018/09/26/163447">KubernetesのNode AffinityとInternal Pod Affinityを使ってPodを高度スケジューリングする - Kekeの日記&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://qiita.com/sheepland/items/ed12b3dc4a8f1df7c4ec">KubernetesのNode Affinity, Inter-Pod Affinityについて - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="deployment">Deployment&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://kubernetes.io/ja/docs/concepts/workloads/controllers/deployment/">https://kubernetes.io/ja/docs/concepts/workloads/controllers/deployment/&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://cstoku.dev/posts/2018/k8sdojo-08/">Kubernetes道場 8日目 - ReplicaSet / Deploymentについて - Toku&amp;rsquo;s Blog&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="spec">spec&lt;/h3>
&lt;h4 id="strategy">strategy&lt;/h4>
&lt;p>更新戦略。&lt;/p>
&lt;p>Example:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-YAML" data-lang="YAML">&lt;span style="color:#204a87;font-weight:bold">spec&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">strategy&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">rollingUpdate&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">maxSurge&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">25&lt;/span>%&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">maxUnavailable&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">25&lt;/span>%&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">type&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>RollingUpdate&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>上はデフォルト値。&lt;/p>
&lt;ul>
&lt;li>type &amp;hellip; &lt;code>Recreate&lt;/code> を選ぶと既存の全てのPodは新しいPodが作成される前に削除される&lt;/li>
&lt;li>&lt;code>maxSurge&lt;/code> &amp;hellip; 理想状態のPod数を超えて作成できる最大のPod数/割合。絶対数も指定可能&lt;/li>
&lt;li>&lt;code>maxUnavailable&lt;/code> &amp;hellip; 更新中に利用不可となる最大のPod数/割合。絶対数も指定可能
&lt;ul>
&lt;li>本番ではキャパシティが低下しないように &lt;code>0&lt;/code> にしておいた方が良さそう。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://qiita.com/TakiTake@github/items/bfc977baf4b909b1e118">KubernetesのRolling updateを安全に行う - Qiita&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://rahmonov.me/posts/zero-downtime-deployment-with-kubernetes/">Zero Downtime Deployment with Kubernetes&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="configmaps--secrets">ConfigMaps &amp;amp; Secrets&lt;/h2>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://cstoku.dev/posts/2018/k8sdojo-11/">Kubernetes道場 11日目 - ConfigMap / Secretについて - Toku&amp;rsquo;s Blog&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://qiita.com/tkusumi/items/cf7b096972bfa2810800">Kubernetes: ConfigMap / Secret の内容を一度に環境変数として読み込む (envFrom) - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="configmaps">ConfigMaps&lt;/h3>
&lt;p>Secretsと似ているが、こちらは値をencodeせずに平文でYAMLに書くので、普通の設定ファイル的な位置づけ。&lt;/p>
&lt;p>公式サイトにいくつかのガイドやサンプルがある:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap/">Use ConfigMap Data in Pods | Kubernetes&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://kubernetes.io/docs/tasks/configure-pod-container/configmap/">Configure Containers Using a ConfigMap | Kubernetes&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://kubernetes.io/docs/tutorials/configuration/configure-redis-using-configmap/">Configuring Redis using a ConfigMap | Kubernetes&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="secrets">Secrets&lt;/h3>
&lt;p>&lt;a href="https://kubernetes.io/docs/concepts/configuration/secret/">https://kubernetes.io/docs/concepts/configuration/secret/&lt;/a>&lt;/p>
&lt;p>パスワードなどテキストをbase64でencodeして保存する。&lt;br>
暗号化の機能もある？&lt;/p>
&lt;p>Podから環境変数として読み込むという使い方をすることが多いようだ。&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://ubiteku.oinker.me/2017/03/01/kubernetes-secrets/">Kubernetes Secrets の紹介 – データベースのパスワードやその他秘密情報をどこに保存するか？ – ゆびてく&lt;/a>&lt;/li>
&lt;/ul>
&lt;h4 id="secretsの作成">Secretsの作成&lt;/h4>
&lt;p>例1) テキストファイルから作成&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-Bash" data-lang="Bash">&lt;span style="color:#204a87">echo&lt;/span> -n &lt;span style="color:#4e9a06">&amp;#39;admin&amp;#39;&lt;/span> &amp;gt; ./username.txt
&lt;span style="color:#204a87">echo&lt;/span> -n &lt;span style="color:#4e9a06">&amp;#39;1f2d1e2e67df&amp;#39;&lt;/span> &amp;gt; ./password.txt
kubectl create secret generic db-user-pass --from-file&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>./username.txt --from-file&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>./password.txt
&lt;/code>&lt;/pre>&lt;/div>&lt;p>例2) 自分で定義ファイル(YAML)を作る&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-Bash" data-lang="Bash">&lt;span style="color:#204a87">echo&lt;/span> -n &lt;span style="color:#4e9a06">&amp;#39;admin&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">|&lt;/span> base64
&lt;span style="color:#000">YWRtaW4&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>
&lt;span style="color:#204a87">echo&lt;/span> -n &lt;span style="color:#4e9a06">&amp;#39;1f2d1e2e67df&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">|&lt;/span> base64
MWYyZDFlMmU2N2Rm
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-YAML" data-lang="YAML">&lt;span style="color:#8f5902;font-style:italic">## secret.yaml&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">apiVersion&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>v1&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">kind&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>Secret&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">metadata&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>mysecret&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">type&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>Opaque&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">data&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">username&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>YWRtaW4=&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">password&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>MWYyZDFlMmU2N2Rm&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-Bash" data-lang="Bash">kubectl apply -f ./secret.yaml
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="resourcequotas">ResourceQuotas&lt;/h2>
&lt;p>&lt;a href="https://kubernetes.io/docs/concepts/policy/resource-quotas/">https://kubernetes.io/docs/concepts/policy/resource-quotas/&lt;/a>&lt;/p>
&lt;p>Example:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-YAML" data-lang="YAML">&lt;span style="color:#204a87;font-weight:bold">apiVersion&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>v1&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">kind&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>ResourceQuota&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">metadata&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>compute-resources&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">spec&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">hard&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">requests.cpu&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;1&amp;#34;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">requests.memory&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>1Gi&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">limits.cpu&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;2&amp;#34;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">limits.memory&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>2Gi&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>適用例:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">kubectl create -f ./compute-resources.yaml --namespace&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>myspace
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Note:&lt;/p>
&lt;ul>
&lt;li>ResourceQuotaを設定したnamespaceに属する全Podの合計値が上限になる&lt;/li>
&lt;li>cpu, memory以外も色々ある&lt;/li>
&lt;/ul>
&lt;h2 id="limitrange">LimitRange&lt;/h2>
&lt;p>&lt;a href="https://kubernetes.io/docs/concepts/policy/limit-range/">https://kubernetes.io/docs/concepts/policy/limit-range/&lt;/a>&lt;/p>
&lt;p>Example:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-YAML" data-lang="YAML">&lt;span style="color:#204a87;font-weight:bold">apiVersion&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>v1&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">kind&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>LimitRange&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">metadata&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>limit-mem-cpu-per-container&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">spec&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">limits&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">max&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">cpu&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;800m&amp;#34;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">memory&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;1Gi&amp;#34;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">min&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">cpu&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;100m&amp;#34;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">memory&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;99Mi&amp;#34;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">default&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">cpu&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;700m&amp;#34;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">memory&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;900Mi&amp;#34;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">defaultRequest&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">cpu&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;110m&amp;#34;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">memory&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;111Mi&amp;#34;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">type&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>Container&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>namespaceに対して設定する&lt;/li>
&lt;li>cpu/memoryのrequests/limitsの下限、上限、デフォルト値を設定できる&lt;/li>
&lt;/ul>
&lt;h2 id="topics">Topics&lt;/h2>
&lt;h3 id="cpumemoryの割り当て">CPU/Memoryの割り当て&lt;/h3>
&lt;p>基本:&lt;/p>
&lt;ul>
&lt;li>Podは、cpu/memory requests以上の空きリソースを持つノードにスケジュールされる&lt;/li>
&lt;li>コンテナのcpu利用量がlimit値を越えるとスロットルされる = パフォーマンス劣化する&lt;/li>
&lt;li>コンテナのmemory利用量がlimit値を越えるとOOM Killerで殺される。再起動できるときは再起動される&lt;/li>
&lt;li>Podが複数のコンテナで構成される場合、リソース指定値は全コンテナの合計値になる&lt;/li>
&lt;li>requestsを指定しないとデフォルト値になる&lt;/li>
&lt;li>limitsを指定しないとノードで利用可能な最大値になる&lt;/li>
&lt;/ul>
&lt;p>Tips:&lt;/p>
&lt;ul>
&lt;li>コンテナのcpu/memoryのrequestsより大きなlimitsを指定することで、突発的な負荷に耐えられるようになり、かつ、適切に制限をかけられる&lt;/li>
&lt;/ul>
&lt;p>ベストプラクティス:&lt;/p>
&lt;ul>
&lt;li>NamespaceでResourceQuotasやLimitRangeを設定すると良い&lt;/li>
&lt;/ul>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://kubernetes.io/ja/docs/tasks/configure-pod-container/assign-cpu-resource/">コンテナおよびPodへのCPUリソースの割り当て - Kubernetes&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://kubernetes.io/ja/docs/tasks/configure-pod-container/assign-memory-resource/">コンテナおよびPodへのメモリーリソースの割り当て - Kubernetes&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.scsk.jp/sp/sysdig/blog/sysdig_monitor/kubernetes_118.html">例を交えてKubernetesのリミットとリクエストを理解する | Sysdigブログ - コンテナ・Kubernetes環境向けセキュリティ・モニタリング プラットフォーム&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://cloud.google.com/blog/products/gcp/kubernetes-best-practices-resource-requests-and-limits">Kubernetes best practices: Resource requests and limits | Google Cloud Blog&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/ja-jp/azure/aks/developer-best-practices-resource-management">開発者のベスト プラクティス - Azure Kubernetes Service (AKS) でのリソース管理 | Microsoft Docs&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>A: Visual Studio Code</title><link>https://progrhy.me/tech-notes/a/program/vscode/</link><pubDate>Mon, 27 Apr 2020 22:33:58 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/program/vscode/</guid><description>
&lt;p>Micfosoftが提供するOSSのクロスプラットフォームなコードエディタ。&lt;br>
Electronをベースにしており、IDE並の機能を持つ。&lt;/p>
&lt;p>3rd Partyの拡張機能も多数あり、機能を拡充することができる。&lt;/p>
&lt;h2 id="documentation">Documentation&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://code.visualstudio.com/docs">https://code.visualstudio.com/docs&lt;/a>
&lt;ul>
&lt;li>Get Started:
&lt;ul>
&lt;li>&lt;a href="https://code.visualstudio.com/docs/getstarted/keybindings">Visual Studio Code Key Bindings&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>User Guide:
&lt;ul>
&lt;li>&lt;a href="https://code.visualstudio.com/docs/editor/extension-gallery">Managing Extensions in Visual Studio Code&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="features">Features&lt;/h2>
&lt;h3 id="スニペット機能">スニペット機能&lt;/h3>
&lt;ul>
&lt;li>ユーザ定義のスニペットを作成可能
&lt;ul>
&lt;li>&lt;code>File &amp;gt; Preferences &amp;gt; User Snippets&lt;/code>&lt;/li>
&lt;li>コメント付きJSON形式で書く&lt;/li>
&lt;li>グローバルなスニペット&lt;/li>
&lt;li>ワークスペースごとのスニペット&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>スニペットが有効になると、補完で選択可能になる&lt;/li>
&lt;/ul>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://vscode-doc-jp.github.io/docs/userguide/userdefinedsnippets.html">独自のスニペットを作成 | 非公式 - Visual Studio Code Docs&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.lisz-works.com/entry/vscode-snippets">VS Codeをスニペット作成は簡単で便利だった！ - lisz-works&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="preferences">Preferences&lt;/h2>
&lt;p>昔はJSON設定ファイルを直接編集するようなスタイルだったが、2018年9月現在、GUIで設定できる項目も増えてきたようだ。&lt;/p>
&lt;p>2種類の設定がある。&lt;/p>
&lt;ul>
&lt;li>ユーザ設定 &amp;hellip; ワークスペースによらない、ユーザ環境で常に有効になる設定。&lt;/li>
&lt;li>ワークスペース設定 &amp;hellip; ワークスペースの &lt;code>.vscode/settings.json&lt;/code> に保存される。&lt;/li>
&lt;/ul>
&lt;p>Quick Reference:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>config&lt;/th>
&lt;th>値（*）&lt;/th>
&lt;th>意味&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>editor.insertSpaces&lt;/code>&lt;/td>
&lt;td>true, false&lt;/td>
&lt;td>ソフトタブ（タブキーで半角スペースを挿入）のon/off&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>editor.renderWhitespace&lt;/code>&lt;/td>
&lt;td>none, all, boundary&lt;/td>
&lt;td>スペースやタブを描画するかどうか。 &lt;code>boundary&lt;/code> では単語境界は描画しない&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>（*）デフォルト値は太字&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://qiita.com/spica/items/cfae8492804b8d3f8726">VSCodeのエディター設定の話 - タブ文字がなぜか半角スペースになってしまう - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="言語ごとの設定を行う">言語ごとの設定を行う&lt;/h3>
&lt;p>インデントなどの設定を言語ごとに変えることができる。&lt;/p>
&lt;p>settings.jsonで &lt;code>&amp;quot;[ruby]&amp;quot;: {}&lt;/code> などのエントリを作って、その中に設定を記述すればいい。&lt;br>
コマンドパレットで &lt;code>Preferences: Configure language specific settings&lt;/code> と入力し、設定したい言語を選ぶやり方もある。&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://ja.stackoverflow.com/questions/34014/visual-studio-code%E3%81%A7%E8%A8%80%E8%AA%9E%E3%81%94%E3%81%A8%E3%81%AB%E3%82%A4%E3%83%B3%E3%83%87%E3%83%B3%E3%83%88%E3%81%AE%E8%A8%AD%E5%AE%9A%E3%82%92%E3%81%97%E3%81%9F%E3%81%84">vscode - Visual Studio Codeで言語ごとにインデントの設定をしたい - スタック・オーバーフロー&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="インデント設定">インデント設定&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>config&lt;/th>
&lt;th>値（*）&lt;/th>
&lt;th>意味&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>editor.detectIndentation&lt;/code>&lt;/td>
&lt;td>&lt;strong>true&lt;/strong>, false&lt;/td>
&lt;td>ファイルタイプごとのインデント設定を有効にする&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>editor.insertSpaces&lt;/code>&lt;/td>
&lt;td>true, false&lt;/td>
&lt;td>ソフトタブ（タブキーで半角スペースを挿入）のon/off&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>editor.tabSize&lt;/code>&lt;/td>
&lt;td>&lt;strong>4&lt;/strong>&lt;/td>
&lt;td>インデント幅&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>（*）デフォルト値は太字&lt;/p>
&lt;p>なぜか設定が反映されないときや、一時的に設定を変更したいときは、画面右下のインデント設定をクリックすることでアドホックに変更が可能。&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.atmarkit.co.jp/ait/articles/1805/25/news039.html">VS Codeでインデントを設定するには：Visual Studio Code TIPS - ＠IT&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://oua-iea-programmer.blogspot.com/2017/04/visual-studio-code.html">【Visual Studio Code】インデント幅の変更方法と、変えても反映されない時の対処法&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ja.stackoverflow.com/questions/34014/visual-studio-code%e3%81%a7%e8%a8%80%e8%aa%9e%e3%81%94%e3%81%a8%e3%81%ab%e3%82%a4%e3%83%b3%e3%83%87%e3%83%b3%e3%83%88%e3%81%ae%e8%a8%ad%e5%ae%9a%e3%82%92%e3%81%97%e3%81%9f%e3%81%84">vscode - Visual Studio Codeで言語ごとにインデントの設定をしたい - スタック・オーバーフロー&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="フォント設定">フォント設定&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>config&lt;/th>
&lt;th>値（*）&lt;/th>
&lt;th>意味&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>editor.fontSize&lt;/code>&lt;/td>
&lt;td>&lt;/td>
&lt;td>エディタのフォントサイズ&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>（*）デフォルト値は太字&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://qiita.com/tkyaji/items/45d5f88047e99c29dda2">Visual Studio Codeでフォントサイズをいい感じにする - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="ファイルを常に新しいタブで開く">ファイルを常に新しいタブで開く&lt;/h3>
&lt;p>&lt;code>workbench.editor.enablePreview: false&lt;/code> に設定し、プレビューを無効化する。&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://code.i-harness.com/">[Visual-Studio-Code] ファイルを常に新しいタブで開くようにvscodeを設定するには？ | CODE Q&amp;amp;A 問題解決 [日本語]&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="テキストの折り返し">テキストの折り返し&lt;/h3>
&lt;p>デフォルトは &lt;code>editor.wordWrap&lt;/code> が折り返さない設定(= &lt;code>off&lt;/code>)になっている。&lt;br>
その他、次のオプションが有る:&lt;/p>
&lt;ul>
&lt;li>&lt;code>on&lt;/code> &amp;hellip; エディタの右端で折り返す&lt;/li>
&lt;li>&lt;code>wordWrapColumn&lt;/code> &amp;hellip; &lt;code>editor.wordWrapColumn&lt;/code> で設定した値で折り返す&lt;/li>
&lt;li>&lt;code>bounded&lt;/code> &amp;hellip; &lt;code>editor.wordWrapColumn&lt;/code> 設定値とエディタの幅の小さい方で折り返す&lt;/li>
&lt;/ul>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://www.atmarkit.co.jp/ait/articles/1807/27/news035.html">VS Codeでテキストの折り返しを設定するには：Visual Studio Code TIPS - ＠IT&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="ショートカットキー">ショートカットキー&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Win/Linux&lt;/th>
&lt;th>Mac&lt;/th>
&lt;th>機能&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>Ctrl+,&lt;/code>&lt;/td>
&lt;td>&lt;code>⌘+,&lt;/code>&lt;/td>
&lt;td>設定画面を開く&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>Ctrl+Shift+p&lt;/code>&lt;/td>
&lt;td>&lt;/td>
&lt;td>コマンドパレットを開く&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>Ctrl+Shift+x&lt;/code>&lt;/td>
&lt;td>&lt;/td>
&lt;td>拡張機能を開く&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>Ctrl+Shift+@&lt;/code>&lt;/td>
&lt;td>&lt;code>⌘+Shift+@&lt;/code>&lt;/td>
&lt;td>ターミナルを開く&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>Ctrl+k v&lt;/code>&lt;/td>
&lt;td>&lt;code>⌘+k v&lt;/code>&lt;/td>
&lt;td>Markdownファイルのプレビュー画面をサイドバイサイドで表示&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>Ctrl+Shift+v&lt;/code>&lt;/td>
&lt;td>&lt;code>⌘+Shift+v&lt;/code>&lt;/td>
&lt;td>Markdownファイルのプレビュー画面を別タブで表示&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>Ctrl+k Ctrl+s&lt;/code>&lt;/td>
&lt;td>&lt;code>⌘+k ⌘+s&lt;/code>&lt;/td>
&lt;td>キーバインド一覧を開く&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>Ctrl+k Ctrl+t&lt;/code>&lt;/td>
&lt;td>&lt;code>⌘+k ⌘+t&lt;/code>&lt;/td>
&lt;td>カラーテーマ(配色)設定&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://qiita.com/oruponu/items/ae9c720d4522c1606daf">Visual Studio Code キーボード ショートカット - Qiita&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.atmarkit.co.jp/ait/articles/1804/20/news030.html">VS CodeでMarkdownをプレビューするには？：Visual Studio Code TIPS - ＠IT&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="キーバインドの変更">キーバインドの変更&lt;/h3>
&lt;p>↑のキーバインド一覧から変更可能&lt;/p>
&lt;h2 id="extensions">Extensions&lt;/h2>
&lt;h3 id="改行コードの表示">改行コードの表示&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://marketplace.visualstudio.com/items?itemName=sohamkamani.code-eol">code-eol&lt;/a>
&lt;ul>
&lt;li>設定値: &lt;code>code-eol.color&lt;/code> &amp;hellip; 改行を表す記号の文字色を16進数のカラーコードで指定。
&lt;ul>
&lt;li>例: &lt;code>&amp;quot;#841a75&amp;quot;&lt;/code> (ラズベリー色)&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://marketplace.visualstudio.com/items?itemName=steditor.line-endings">line-endings&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>2018年9月、code-eolを入れて使っている。&lt;/p>
&lt;h3 id="textlint">textlint&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://marketplace.visualstudio.com/items?itemName=taichi.vscode-textlint">vscode-textlint&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>日本語の書き方など指摘・修正してくれるLintツール。&lt;/p>
&lt;p>使い方:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://qiita.com/azu/items/2c565a38df5ed4c9f4e1#%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB">VS Codeでtextlintを使って文章をチェックする - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="how-to">How-to&lt;/h2>
&lt;h3 id="vs-codeの更新">VS Codeの更新&lt;/h3>
&lt;p>Ubuntu:&lt;/p>
&lt;ol>
&lt;li>debパッケージをダウンロード&lt;/li>
&lt;li>&lt;code>sudo dpkg -i code_xxx.deb&lt;/code>&lt;/li>
&lt;/ol></description></item><item><title>A: Bitbucket</title><link>https://progrhy.me/tech-notes/a/web-service/bitbucket/</link><pubDate>Tue, 28 Apr 2020 00:22:53 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/web-service/bitbucket/</guid><description>
&lt;p>Atlassian社が提供しているソースコードのホスティングサービス。&lt;br>
JIRAなど他のAtlassian製品との連携が強み（だと思う）。&lt;/p>
&lt;h2 id="提供形態">提供形態&lt;/h2>
&lt;ul>
&lt;li>クラウド &amp;hellip; Bitbucket Cloud&lt;/li>
&lt;li>セルフホスト &amp;hellip; オンプレミス
&lt;ul>
&lt;li>Bitbucket Server &amp;hellip; 単一サーバ&lt;/li>
&lt;li>Bitbucket Datacenter &amp;hellip; クラスタ構成&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="features">Features&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://www.atlassian.com/ja/software/bitbucket/features/pipelines">Pipelines&lt;/a> &amp;hellip; 付属のCI/CDツール&lt;/li>
&lt;/ul></description></item><item><title>A: Git</title><link>https://progrhy.me/tech-notes/a/software/git/</link><pubDate>Mon, 27 Apr 2020 23:03:01 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/software/git/</guid><description>
&lt;h2 id="gitコマンド">gitコマンド&lt;/h2>
&lt;h3 id="参考資料">参考資料&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="http://qiita.com/konweb/items/621722f67fdd8f86a017">【Git】基本コマンド - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="apply">apply&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic">## git diffコマンドで作ったpatchを適用する&lt;/span>
git apply file.patch
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://maku77.github.io/git/git-patch.html">Git でパッチファイルを作成する | まくまくGitノート&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="archive">archive&lt;/h3>
&lt;p>NOTE:&lt;/p>
&lt;ul>
&lt;li>tar を使わないとファイルに実行ビットがついてしまうようだ。&lt;/li>
&lt;/ul>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://qiita.com/usamik26/items/9a2d14aea30cb01a60c6" title="Git リポジトリの内容を zip ファイルにする - Qiita">Git リポジトリの内容を zip ファイルにする - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="checkout">checkout&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic">## topicブランチを作成&lt;/span>
git checkout -b topic
&lt;span style="color:#8f5902;font-style:italic">## remoteブランチからローカルブランチを作成&lt;/span>
git checkout -b foo origin/foo
&lt;span style="color:#8f5902;font-style:italic">## 空ブランチを作る&lt;/span>
git checkout --orphan empty
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://qiita.com/akiko-pusu/items/7c0a99b8cb37882d2cfe" title="gitの空ブランチを作る - Qiita">gitの空ブランチを作る - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="cherry-pick">cherry-pick&lt;/h3>
&lt;p>別ブランチで開発中の機能などをコミット単位で取り込むときに使う。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">git cherry-pick &amp;lt;SHA1&amp;gt;
&lt;span style="color:#8f5902;font-style:italic">## マージコミットのcherry-pick&lt;/span>
git cherry-pick -m &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &amp;lt;SHA1&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://qiita.com/takc923/items/8e2d87d692f840b14464" title="merge commitをcherry-pickする - Qiita">merge commitをcherry-pickする - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="clone">clone&lt;/h3>
&lt;p>&lt;a href="https://git-scm.com/docs/git-clone">https://git-scm.com/docs/git-clone&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic">## 深さ1の shallow clone&lt;/span>
git clone --depth &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &amp;lt;URL&amp;gt;
&lt;span style="color:#8f5902;font-style:italic">## ブランチ指定&lt;/span>
git clone --branch BRANCH URL
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="commit">commit&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic">## 変更点を表示してコミット&lt;/span>
git commit -v
&lt;span style="color:#8f5902;font-style:italic">## 空コミット&lt;/span>
git commit --allow-empty
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="diff">diff&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">&lt;span style="color:#8f5902;font-style:italic">## スペース等の差分を無視&lt;/span>
git diff -w
&lt;span style="color:#8f5902;font-style:italic">## ファイル名のみ表示&lt;/span>
git diff --name-only
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="fetch">fetch&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic">## remote で削除された branch について、local のトラッキングブランチも消す&lt;/span>
git fetch -p&lt;span style="color:#000;font-weight:bold">|&lt;/span>--prune
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="log">log&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic">## 過去のコミットから対象文字列を含むコミットを検索&lt;/span>
git log -S 文字列
&lt;span style="color:#8f5902;font-style:italic">## 1行で表示&lt;/span>
git log --pretty&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>oneline
git log --oneline --graph --decorate
&lt;span style="color:#8f5902;font-style:italic">## フォーマット指定&lt;/span>
git log --format&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;%H&amp;#34;&lt;/span> &lt;span style="color:#8f5902;font-style:italic"># full commit hash のみ&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://git-scm.com/book/ja/v1/Git-%E3%81%AE%E3%81%95%E3%81%BE%E3%81%96%E3%81%BE%E3%81%AA%E3%83%84%E3%83%BC%E3%83%AB-%E3%83%AA%E3%83%93%E3%82%B8%E3%83%A7%E3%83%B3%E3%81%AE%E9%81%B8%E6%8A%9E" title="Git - リビジョンの選択">Git - リビジョンの選択&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://heart-shaped-chocolate.hatenablog.jp/entry/2013/07/16/035104" title="git logのオプションあれこれ - 煙と消えるその前に">git logのオプションあれこれ - 煙と消えるその前に&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://qiita.com/key-amb/items/9ee8339d2da971581cfb" title="git log をいい感じに alias して色付きで見やすくしておく - Qiita">git log をいい感じに alias して色付きで見やすくしておく - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="rebase">rebase&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic">## 過去のNコミットを編集&lt;/span>
git rebase -i HEAD~N
&lt;span style="color:#8f5902;font-style:italic">## 1st コミットから編集&lt;/span>
git rebase -i --root
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://d.hatena.ne.jp/ken_c_lo/20130421/1366558065" title="First commit が git rebase -i できない問題 → git rebase -i --root でできる - 納豆には卵を入れる派です。">First commit が git rebase -i できない問題 → git rebase -i &amp;ndash;root でできる - 納豆には卵を入れる派です。&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="remote">remote&lt;/h3>
&lt;p>リモートリポジトリの管理。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic">## リモートリポジトリ一覧&lt;/span>
git remote
git remote -v
&lt;span style="color:#8f5902;font-style:italic">## リモートリポジトリ追加&lt;/span>
git remote add &amp;lt;リポジトリ名&amp;gt; &amp;lt;URL&amp;gt;
&lt;span style="color:#8f5902;font-style:italic">## リモートリポジトリ削除&lt;/span>
git remote rm &amp;lt;リポジトリ名&amp;gt;
&lt;span style="color:#8f5902;font-style:italic">## URL変更&lt;/span>
git remote set-url &amp;lt;リポジトリ名&amp;gt; &amp;lt;URL&amp;gt;
&lt;span style="color:#8f5902;font-style:italic">## リポジトリ名変更&lt;/span>
git remote rename &amp;lt;リポジトリ名&amp;gt; &amp;lt;新しいリポジトリ名&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.sejuku.net/blog/71492">これで完璧! git remoteでリポジトリを【追加,削除,確認,変更】 | 侍エンジニア塾ブログ（Samurai Blog） - プログラミング入門者向けサイト&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="revert">revert&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">git revert &amp;lt;SHA1&amp;gt;
&lt;span style="color:#8f5902;font-style:italic">## マージコミットの取消し&lt;/span>
git revert -m &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &amp;lt;SHA1&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/git/git/blob/master/Documentation/howto/revert-a-faulty-merge.txt">https://github.com/git/git/blob/master/Documentation/howto/revert-a-faulty-merge.txt&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://d.hatena.ne.jp/koba04/20121122/1353512656" title="gitのmerge-commitをrevertする - 車輪を再発明 / koba04の日記">gitのmerge-commitをrevertする - 車輪を再発明 / koba04の日記&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="submodule">submodule&lt;/h3>
&lt;p>&lt;a href="https://git-scm.com/docs/git-submodule">https://git-scm.com/docs/git-submodule&lt;/a>&lt;/p>
&lt;p>なんだかんだで割りと使っている。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic">## 全submodule更新&lt;/span>
git submodule foreach git pull origin master
&lt;/code>&lt;/pre>&lt;/div>&lt;p>sumobuleの削除 =&amp;gt; &lt;a href="https://github.com/progrhyme/git-wraps/blob/master/bin/git-submodule-delete">https://github.com/progrhyme/git-wraps/blob/master/bin/git-submodule-delete&lt;/a>&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://qiita.com/sotarok/items/0d525e568a6088f6f6bb" title="Git submodule の基礎 - Qiita">Git submodule の基礎 - Qiita&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://qiita.com/kshimo69/items/ac22d414d756ea08943f" title="git submoduleしてるリポジトリをリモートの最新に更新する - Qiita">git submoduleしてるリポジトリをリモートの最新に更新する - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h4 id="向き先url変更">向き先url変更&lt;/h4>
&lt;ol>
&lt;li>&lt;code>.gitmodules&lt;/code> の向き先を新urlに変更&lt;/li>
&lt;li>&lt;code>git submodule sync&lt;/code> で反映
&lt;ul>
&lt;li>&lt;code>.git/config&lt;/code> に変更が反映される&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>git submodule update&lt;/code> とかで更新&lt;/li>
&lt;/ol>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://qiita.com/8mamo10/items/fd11d8c7a2d928b39173" title="submodule の向き先 url を変更する - Qiita">submodule の向き先 url を変更する - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="tag">tag&lt;/h3>
&lt;p>SYNOPSIS:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">&lt;span style="color:#8f5902;font-style:italic">## 作成&lt;/span>
git tag &amp;lt;タグ名&amp;gt;
&lt;span style="color:#8f5902;font-style:italic">### 注釈付き&lt;/span>
git tag -a &amp;lt;タグ名&amp;gt; -m &amp;lt;メッセージ&amp;gt;
&lt;span style="color:#8f5902;font-style:italic">## 表示&lt;/span>
git show &amp;lt;タグ名&amp;gt;
&lt;span style="color:#8f5902;font-style:italic">### 一覧&lt;/span>
git tag
&lt;span style="color:#8f5902;font-style:italic">## 削除&lt;/span>
git tag -d &amp;lt;タグ名&amp;gt;
&lt;span style="color:#8f5902;font-style:italic">## リモートに反映&lt;/span>
git push &amp;lt;リモート&amp;gt; &amp;lt;タグ名&amp;gt;
git push --tags
&lt;span style="color:#8f5902;font-style:italic">### 削除反映&lt;/span>
git push &amp;lt;リモート&amp;gt; :&amp;lt;タグ名&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://qiita.com/chihiro/items/cba40015b1aa2c73b78a">【Git】tag関連コマンド - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="tips">Tips&lt;/h2>
&lt;h3 id="歴史を改ざんする">歴史を改ざんする&lt;/h3>
&lt;p>See &lt;a href="https://git-scm.com/book/ja/v2/Git-%E3%81%AE%E3%81%95%E3%81%BE%E3%81%96%E3%81%BE%E3%81%AA%E3%83%84%E3%83%BC%E3%83%AB-%E6%AD%B4%E5%8F%B2%E3%81%AE%E6%9B%B8%E3%81%8D%E6%8F%9B%E3%81%88">Git - 歴史の書き換え&lt;/a>&lt;/p>
&lt;h4 id="特定のファイルディレクトリの履歴を完全に削除">特定のファイル・ディレクトリの履歴を完全に削除&lt;/h4>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic">## file&lt;/span>
git filter-branch --tree-filter &lt;span style="color:#4e9a06">&amp;#39;rm -f path/to/file&amp;#39;&lt;/span> HEAD
&lt;span style="color:#8f5902;font-style:italic">## directory&lt;/span>
git filter-branch --tree-filter &lt;span style="color:#4e9a06">&amp;#39;rm -rf path/to/dir/&amp;#39;&lt;/span> HEAD
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://gist.github.com/ktx2207/3167fa69531bdd6b44f1">Git ファイルの履歴を完全に削除する&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="マージコミットを-cherry-pick">マージコミットを cherry-pick&lt;/h3>
&lt;p>merge commit を cherry-pick&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">git cherry-pick -m &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &amp;lt;merge commit のハッシュ&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://qiita.com/takc923/items/8e2d87d692f840b14464" title="merge commitをcherry-pickする - Qiita">merge commitをcherry-pickする - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="特定のファイルを-git-管理対象から除外する">特定のファイルを Git 管理対象から除外する&lt;/h3>
&lt;h4 id="1-gitignore-や-gitinfoexclude-を使う">1) &lt;code>.gitignore&lt;/code> や &lt;code>.git/info/exclude&lt;/code> を使う&lt;/h4>
&lt;h4 id="2-既に-git-管理下にあるファイルをワーキングツリーで敢えて除外する">2) 既に Git 管理下にあるファイルをワーキングツリーで敢えて除外する&lt;/h4>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">git update-index —assume-unchanged &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>ファイル名&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span>
git update-index —skip-worktree &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>ファイル名&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">## 確認&lt;/span>
git ls-files -v
&lt;span style="color:#8f5902;font-style:italic">## 取り消し&lt;/span>
git update-index —no-assume-unchanged &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>ファイル名&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span>
git update-index —no-skip-worktree &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>ファイル名&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>git ls-files -v の表示:&lt;/p>
&lt;ul>
&lt;li>assume-unchanged 設定のファイルは、状態が小文字で表示される&lt;/li>
&lt;li>skip-worktree 設定のファイルは、状態が S と表示される&lt;/li>
&lt;/ul>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://qiita.com/usamik26/items/56d0d3ba7a1300625f92">既に git 管理しているファイルをあえて無視したい - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="リポジトリをサブディレクトリで分割">リポジトリをサブディレクトリで分割&lt;/h3>
&lt;h4 id="サブディレクトリが1つの場合">サブディレクトリが1つの場合&lt;/h4>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">git clone original_dir new_dir
&lt;span style="color:#204a87">cd&lt;/span> new_dir
git filter-branch --subdirectory-filter sub_dir_name HEAD
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://akio0911.net/archives/3421">gitリポジトリのサブディレクトリを別のリポジトリとして抽出する方法 - 拡張現実ライフ&lt;/a>&lt;/li>
&lt;/ul>
&lt;h4 id="サブディレクトリが複数の場合">サブディレクトリが複数の場合&lt;/h4>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://stackoverflow.com/questions/2982055/detach-many-subdirectories-into-a-new-separate-git-repository">git filter branch - Detach many subdirectories into a new, separate Git repository - Stack Overflow&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>A: CLI</title><link>https://progrhy.me/tech-notes/a/software/terraform/cli/</link><pubDate>Sun, 26 Apr 2020 23:06:08 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/software/terraform/cli/</guid><description>
&lt;p>&lt;a href="https://www.terraform.io/docs/commands/">https://www.terraform.io/docs/commands/&lt;/a>&lt;/p>
&lt;h2 id="import">import&lt;/h2>
&lt;p>&lt;a href="https://www.terraform.io/docs/import/usage.html">https://www.terraform.io/docs/import/usage.html&lt;/a>&lt;/p>
&lt;p>&lt;code>terraform import&lt;/code> コマンドにより、既存インフラをTerraform管理下に置くことができる。&lt;/p>
&lt;p>一部インフラを手動で作った後、リソースのidを指定して取り込む、といった使い方ができる。&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://qiita.com/tyasu/items/32b23dd76d25f7af712f" title="terraform importの使い方メモ - Qiita">terraform importの使い方メモ - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="plan">plan&lt;/h2>
&lt;p>&lt;a href="https://www.terraform.io/docs/commands/plan.html">https://www.terraform.io/docs/commands/plan.html&lt;/a>&lt;/p>
&lt;p>Examples:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">&lt;span style="color:#8f5902;font-style:italic"># 対象を限定する&lt;/span>
terraform plan -target&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>resource_type1.identifier1 -target&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>resource_type2.identifier2
&lt;span style="color:#8f5902;font-style:italic"># planファイルを書き出す&lt;/span>
terraform plan -out&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>path/to/tfplan
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="state">state&lt;/h2>
&lt;p>&lt;a href="https://www.terraform.io/docs/commands/state/">https://www.terraform.io/docs/commands/state/&lt;/a>&lt;/p>
&lt;p>stateの管理・編集を行うコマンド。&lt;/p>
&lt;p>SYNOPSIS:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">terraform state list &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>filtering-arg&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span> &lt;span style="color:#8f5902;font-style:italic"># terraform管理下のリソース一覧&lt;/span>
terraform state pull &lt;span style="color:#8f5902;font-style:italic"># リモートのstateファイルをダウンロードして標準出力に表示&lt;/span>
terraform state push &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>OPTION&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span> PATH &lt;span style="color:#8f5902;font-style:italic"># ローカルのstateファイルをリモートにアップロード&lt;/span>
terraform state mv SOURCE DESTINATION &lt;span style="color:#8f5902;font-style:italic"># リソースの名称変更。module化も可能&lt;/span>
terraform state rm リソース &lt;span style="color:#8f5902;font-style:italic"># リソースをterraform管理から除く = tfstateファイルから削除&lt;/span>
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>A: GitBook</title><link>https://progrhy.me/tech-notes/a/software/gitbook/</link><pubDate>Sat, 25 Apr 2020 23:52:08 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/software/gitbook/</guid><description>
&lt;p>Markdownで管理されたドキュメントからHTML, PDF, ePUBに簡単に製本できるツール。&lt;br>
ただし、2020-04-25現在、クラウドサービスに注力するそうで、OSSのツールチェインは不活発になっていくようだ。&lt;/p>
&lt;p>&lt;a href="https://github.com/GitbookIO/gitbook">https://github.com/GitbookIO/gitbook&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>⚠️ Deprecation warning&lt;/strong>&lt;/p>
&lt;p>As the efforts of the GitBook team are focused on the &lt;a href="https://www.gitbook.com">GitBook.com&lt;/a> platform, the CLI is no longer under active development.&lt;br>
All content supported by the CLI are mostly supported by our &lt;a href="https://docs.gitbook.com/integrations/github">GitBook.com / GitHub integration&lt;/a>.&lt;br>
Content hosted on the &lt;a href="https://legacy.gitbook.com">legacy.gitbook.com&lt;/a> will continue working until further notice. For differences with the new vesion, check out our &lt;a href="https://docs.gitbook.com/v2-changes/important-differences">documentation&lt;/a>.&lt;/p>
&lt;/blockquote>
&lt;h2 id="documentation">Documentation&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://docs.gitbook.com/">https://docs.gitbook.com/&lt;/a> &amp;hellip; クラウドサービス向け&lt;/li>
&lt;li>&lt;a href="https://gitbookio.gitbooks.io/documentation/">Introduction | GitBook.com Documentation&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/GitbookIO/gitbook/tree/master/docs">https://github.com/GitbookIO/gitbook/tree/master/docs&lt;/a> &amp;hellip; たぶんOSSツールチェインのドキュメントはもうここを読むしかない。&lt;/li>
&lt;/ul>
&lt;h2 id="plugins">Plugins&lt;/h2>
&lt;p>目次生成系:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://developer.aliyun.com/mirror/npm/package/gitbook-plugin-page-toc">Package - gitbook-plugin-page-toc&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/zanfab/gitbook-plugin-intopic-toc">zanfab/gitbook-plugin-intopic-toc: GitBook Plugin to add inline table of contents (TOC) to each page using sticky and scrollspy effects.&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/billryan/gitbook-plugin-etoc">billryan/gitbook-plugin-etoc: Elegant toc plugin for GitBook&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://qiita.com/mebiusbox2/items/938af4b0d0bf7a4d3e33#gitbook-cli">GitBookによるドキュメント作成 - Qiita&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>A: Backends</title><link>https://progrhy.me/tech-notes/a/software/terraform/backend/</link><pubDate>Sun, 26 Apr 2020 23:05:57 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/software/terraform/backend/</guid><description>
&lt;blockquote>
&lt;p>A &amp;ldquo;backend&amp;rdquo; in Terraform determines how state is loaded and how an operation such as &lt;code>apply&lt;/code> is executed. This abstraction enables non-local file state storage, remote execution, etc.&lt;/p>
&lt;/blockquote>
&lt;h2 id="gcs">gcs&lt;/h2>
&lt;p>&lt;a href="https://www.terraform.io/docs/backends/types/gcs.html">https://www.terraform.io/docs/backends/types/gcs.html&lt;/a>&lt;/p>
&lt;ul>
&lt;li>認証用の &lt;code>credentials&lt;/code> または &lt;code>access_token&lt;/code> が必要。
&lt;ul>
&lt;li>&lt;a href="https://cloud.google.com/sdk/gcloud/reference/auth/application-default/login">https://cloud.google.com/sdk/gcloud/reference/auth/application-default/login&lt;/a> で作成できるユーザのApplication Default Credentialsでも良い&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="s3">s3&lt;/h2>
&lt;p>&lt;a href="https://www.terraform.io/docs/backends/types/s3.html">https://www.terraform.io/docs/backends/types/s3.html&lt;/a>&lt;/p>
&lt;ul>
&lt;li>ロックしたいときはDynamoDBを使う。
&lt;ul>
&lt;li>オプション &lt;code>dynamodb_table&lt;/code> を指定する&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item><item><title>A: UNIX系コマンド</title><link>https://progrhy.me/tech-notes/a/cli/unix-cmd/</link><pubDate>Mon, 27 Apr 2020 19:37:41 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/cli/unix-cmd/</guid><description>
&lt;p>筆者はLinuxかmacOSを使うことが多い。&lt;/p>
&lt;h2 id="about">About&lt;/h2>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://en.wikipedia.org/wiki/List_of_Unix_commands">List of Unix commands - Wikipedia&lt;/a> &amp;hellip; IEEE規格らしい。&lt;/li>
&lt;/ul>
&lt;h2 id="日付時刻時間">日付・時刻・時間&lt;/h2>
&lt;h3 id="date">date&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic">## 書式指定&lt;/span>
date +%Y%m%d &lt;span style="color:#8f5902;font-style:italic"># YYYYMMDD&lt;/span>
date +%FT%T &lt;span style="color:#8f5902;font-style:italic"># ISO8601風&lt;/span>
date +%s &lt;span style="color:#8f5902;font-style:italic"># unixtime&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">## 日時指定/相対&lt;/span>
date -d tomorrow &lt;span style="color:#8f5902;font-style:italic"># 明日&lt;/span>
date -d &lt;span style="color:#4e9a06">&amp;#39;1 hour&amp;#39;&lt;/span> &lt;span style="color:#8f5902;font-style:italic"># 1時間後&lt;/span>
date -d &lt;span style="color:#4e9a06">&amp;#39;1 days ago&amp;#39;&lt;/span> &lt;span style="color:#8f5902;font-style:italic"># 昨日&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">## 日時指定/絶対&lt;/span>
date -d @1530675922 &lt;span style="color:#8f5902;font-style:italic"># unixtime&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>NOTE:&lt;/p>
&lt;ul>
&lt;li>Mac だと &lt;code>-d '〜'&lt;/code> オプションが使えない&lt;/li>
&lt;/ul>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://shellscript.sunone.me/date.html" title="日付を取得する | UNIX &amp;amp; Linux コマンド・シェルスクリプト リファレンス">日付を取得する | UNIX &amp;amp; Linux コマンド・シェルスクリプト リファレンス&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://hydrocul.github.io/wiki/commands/date.html">date コマンド | コマンドの使い方(Linux) | hydroculのメモ&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="ファイル操作">ファイル操作&lt;/h2>
&lt;h3 id="tee">tee&lt;/h3>
&lt;p>標準出力に書きつつファイルにも書く、ということをやりたいときに使う。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">./a.sh &lt;span style="color:#000;font-weight:bold">|&lt;/span> tee a.log
./a.sh &lt;span style="color:#000;font-weight:bold">|&lt;/span> tee -a a.log &lt;span style="color:#8f5902;font-style:italic"># 追記&lt;/span>
./a.sh 2&amp;gt;&lt;span style="color:#000;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#000;font-weight:bold">|&lt;/span> tee a.log &lt;span style="color:#8f5902;font-style:italic"># 標準エラーもファイルに書く&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://qiita.com/wnoguchi/items/2fc3ec11043d139dc6bb" title="teeコマンドの使い方 - Qiita">teeコマンドの使い方 - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="touch">touch&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">touch -t &lt;span style="color:#0000cf;font-weight:bold">201807040100&lt;/span> path/to/file &lt;span style="color:#8f5902;font-style:italic"># mtimeを2018/7/4 01:00に変更&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://www.atmarkit.co.jp/ait/articles/1606/14/news013.html">【 touch 】コマンド――タイムスタンプを変更する／新規ファイルを作成する：Linux基本コマンドTips（23） - ＠IT&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="アーカイブ">アーカイブ&lt;/h2>
&lt;h3 id="zipunzip">zip/unzip&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic">## dir/ を再帰的に圧縮&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">## 展開すると dir/ も出来る&lt;/span>
zip -r foo.zip dir/
&lt;span style="color:#8f5902;font-style:italic">## 中身を bar/ に展開&lt;/span>
unzip foo.zip -d bar/
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://itpro.nikkeibp.co.jp/article/COLUMN/20060228/231001/?rt=nocnt" title="Linuxコマンド集 - 【 zip 】 ファイルを圧縮する（拡張子.zip）：ITpro">Linuxコマンド集 - 【 zip 】 ファイルを圧縮する（拡張子.zip）：ITpro&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.atmarkit.co.jp/ait/articles/1607/26/news014.html" title="Linux基本コマンドTips（35）：unzipコマンド――ZIPファイルからファイルを取り出す - ＠IT">Linux基本コマンドTips（35）：unzipコマンド――ZIPファイルからファイルを取り出す - ＠IT&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="テキスト処理">テキスト処理&lt;/h2>
&lt;h3 id="grep">grep&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic">## ファイル名だけ表示&lt;/span>
grep -l PATTERN &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>PATH&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="head">head&lt;/h3>
&lt;p>&lt;a href="https://linuxjm.osdn.jp/html/GNU_textutils/man1/head.1.html">https://linuxjm.osdn.jp/html/GNU_textutils/man1/head.1.html&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">&lt;span style="color:#8f5902;font-style:italic">## 先頭1行を表示&lt;/span>
head -1 &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>file...&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">## 先頭20行を表示&lt;/span>
head -n &lt;span style="color:#0000cf;font-weight:bold">20&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>file...&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">## 先頭256Bを表示&lt;/span>
head -c &lt;span style="color:#0000cf;font-weight:bold">256&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>file...&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">## 先頭256KBを表示&lt;/span>
head --bytes 256k &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>file...&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="sort">sort&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic">## 第2フィールドで数値の降順ソート&lt;/span>
cat file &lt;span style="color:#000;font-weight:bold">|&lt;/span> sort -nr -k2
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://linuxjm.osdn.jp/html/gnumaniak/man1/sort.1.html">https://linuxjm.osdn.jp/html/gnumaniak/man1/sort.1.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://hydrocul.github.io/wiki/commands/sort.html" title="sort コマンド | コマンドの使い方(Linux) | hydroculのメモ">sort コマンド | コマンドの使い方(Linux) | hydroculのメモ&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="ファイルシステム">ファイルシステム&lt;/h2>
&lt;h3 id="exportfs">exportfs&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">exportfs -a &lt;span style="color:#8f5902;font-style:italic"># /etc/exports の全てのディレクトリをエクスポート&lt;/span>
exportfs -v &lt;span style="color:#8f5902;font-style:italic"># 現在エクスポート中のディレクトリ一覧&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.ibm.com/support/knowledgecenter/ja/ssw_aix_71/com.ibm.aix.cmds2/exportfs.htm">exportfs コマンド&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="mount">mount&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">&lt;span style="color:#8f5902;font-style:italic">## uid, gid指定&lt;/span>
mount -o &lt;span style="color:#000">uid&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>1000,gid&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1000&lt;/span> /dev/sdb1 /mnt
&lt;/code>&lt;/pre>&lt;/div>&lt;p>※NFSの場合、uid/gid指定は不可&lt;/p>
&lt;p>See also:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://sites.google.com/site/progrhymetechwiki/linux/fs">https://sites.google.com/site/progrhymetechwiki/linux/fs&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://www.atmarkit.co.jp/ait/articles/1802/15/news035.html">【 mount 】コマンド――ファイルシステムをマウントする：Linux基本コマンドTips（183） - ＠IT&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.atmarkit.co.jp/fwin2k/productreview/sfu35-01/sfu35_01_03.html">製品レビュー：企業ユーザーのためのSFU 3.5活用ガイダンス　第1回　SFU 3.5の概要とNFS機能　2．NFSとユーザー名マッピング - ＠IT&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="umount">umount&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">umount &amp;lt;mount先&amp;gt;
umount &amp;lt;mount元&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ユーザ管理">ユーザ管理&lt;/h2>
&lt;h3 id="getent">getent&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">getent group &amp;lt;group&amp;gt; &lt;span style="color:#8f5902;font-style:italic"># グループに属しているユーザをリスト&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://qiita.com/niiyz/items/53aa4195dcc69db2052b">Linuxコマンドでユーザーのグループ確認・変更。 - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="gpasswd">gpasswd&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">gpasswd -a &amp;lt;login&amp;gt; &amp;lt;group&amp;gt; &lt;span style="color:#8f5902;font-style:italic"># ユーザをグループに所属させる&lt;/span>
gpasswd -d &amp;lt;login&amp;gt; &amp;lt;group&amp;gt; &lt;span style="color:#8f5902;font-style:italic"># ユーザをグループから削除&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://www.atmarkit.co.jp/ait/articles/1612/12/news016.html" title="【 gpasswd 】コマンド――ユーザーが所属するグループを管理する：Linux基本コマンドTips（72） - ＠IT">【 gpasswd 】コマンド――ユーザーが所属するグループを管理する：Linux基本コマンドTips（72） - ＠IT&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="groupadd">groupadd&lt;/h3>
&lt;p>グループ作成。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">groupadd newgroup
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://webkaru.net/linux/groupadd-command/" title="Linuxコマンド【 groupadd 】新規グループの作成 - Linux入門 - Webkaru">Linuxコマンド【 groupadd 】新規グループの作成 - Linux入門 - Webkaru&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="passwd">passwd&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">passwd -l &amp;lt;login&amp;gt; &lt;span style="color:#8f5902;font-style:italic"># アカウントをロック&lt;/span>
passwd -u &amp;lt;login&amp;gt; &lt;span style="color:#8f5902;font-style:italic"># アンロック&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ロックされたアカウントはログインできず、利用不可になる。&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://kazmax.zpp.jp/linux/account_lock.html" title="Linux ユーザーアカウントをロック・アンロックする">Linux ユーザーアカウントをロック・アンロックする&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="useradd">useradd&lt;/h3>
&lt;p>ユーザ追加。オプション多数&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>オプション&lt;/th>
&lt;th>意味&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>-m&lt;/code>&lt;/td>
&lt;td>ホームディレクトリ作成&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>-s &amp;lt;SHELL&amp;gt;&lt;/code>&lt;/td>
&lt;td>ログインシェルを指定&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>Examples:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-Bash" data-lang="Bash">&lt;span style="color:#8f5902;font-style:italic">## ホームディレクトリ作成&lt;/span>
useradd -m &amp;lt;login&amp;gt;
&lt;span style="color:#8f5902;font-style:italic">## ログインシェルを/bin/bashに&lt;/span>
useradd -s /bin/bash &amp;lt;login&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://eng-entrance.com/linux-command-useradd">useraddコマンドについて詳しくまとめました 【Linuxコマンド集】&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="usermod">usermod&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">usermod -g admin &amp;lt;login&amp;gt; &lt;span style="color:#8f5902;font-style:italic"># 主グループを変更&lt;/span>
usermod -aG ops,app,... &amp;lt;login&amp;gt; &lt;span style="color:#8f5902;font-style:italic"># 副グループ追加&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://eng-entrance.com/linux-command-usermod" title="usermodコマンドについて詳しくまとめました 【Linuxコマンド集】">usermodコマンドについて詳しくまとめました 【Linuxコマンド集】&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="リソース管理">リソース管理&lt;/h2>
&lt;h3 id="ps">ps&lt;/h3>
&lt;p>&lt;a href="https://linuxjm.osdn.jp/html/procps/man1/ps.1.html">Man page of PS&lt;/a>&lt;/p>
&lt;p>Examples:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">ps aux
ps aufxwww
ps auxwww -L
ps -ef
ps -efL
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Options:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>option&lt;/th>
&lt;th>意味&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>f&lt;/code>&lt;/td>
&lt;td>forest, プロセスをツリー状に表示&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>-L&lt;/code>&lt;/td>
&lt;td>スレッド表示。 &lt;code>f&lt;/code> と同時に指定はできない&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="top1">top(1)&lt;/h3>
&lt;p>&lt;a href="https://linux.die.net/man/1/top">top(1): tasks - Linux man page&lt;/a>&lt;/p>
&lt;p>Examples:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">&lt;span style="color:#8f5902;font-style:italic"># インタラクティブモード&lt;/span>
top
&lt;span style="color:#8f5902;font-style:italic">## 描画間隔を5秒に変更&lt;/span>
top -d &lt;span style="color:#0000cf;font-weight:bold">5&lt;/span>
&lt;span style="color:#8f5902;font-style:italic"># バッチモードで1回だけ実行&lt;/span>
top -b -n &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">## CPUコアごとの負荷も表示&lt;/span>
top -b -n &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> -1
&lt;/code>&lt;/pre>&lt;/div>&lt;p>インタラクティブモードの主な操作:&lt;/p>
&lt;ul>
&lt;li>&lt;code>M&lt;/code> &amp;hellip; メモリ使用率順にソート&lt;/li>
&lt;li>&lt;code>P&lt;/code> &amp;hellip; CPU使用率順にソート&lt;/li>
&lt;li>&lt;code>1&lt;/code> &amp;hellip; CPUコアごとの負荷を表示&lt;/li>
&lt;li>&lt;code>c&lt;/code> &amp;hellip; プロセス名詳細を表示（トグル）&lt;/li>
&lt;li>&lt;code>q&lt;/code> &amp;hellip; 終了&lt;/li>
&lt;li>&lt;code>F&lt;/code> or &lt;code>O&lt;/code> &amp;hellip; ソートするフィールドを選ぶ&lt;/li>
&lt;li>&lt;code>R&lt;/code> &amp;hellip; ソートの昇順/降順を切り替え&lt;/li>
&lt;/ul>
&lt;p>Mac版の違い:&lt;/p>
&lt;ul>
&lt;li>&lt;code>-b&lt;/code> オプションやバッチモードがなさそう&lt;/li>
&lt;li>CPUコアごとに負荷を見る方法がわからん&lt;/li>
&lt;/ul>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://bashalog.c-brains.jp/11/05/24-220315.php">[Linux] top コマンドをインタラクティブに操作する | バシャログ。&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="ユーティリティー">ユーティリティー&lt;/h2>
&lt;h3 id="watch">watch&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">watch -n &amp;lt;N&amp;gt; &lt;span style="color:#204a87">command&lt;/span> args...
&lt;/code>&lt;/pre>&lt;/div>&lt;p>N秒ごとにコマンドを実行して出力を表示。&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://hydrocul.github.io/wiki/commands/watch.html" title="watch コマンド | コマンドの使い方(Linux) | hydroculのメモ">watch コマンド | コマンドの使い方(Linux) | hydroculのメモ&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>A: Zsh</title><link>https://progrhy.me/tech-notes/a/cli/zsh/</link><pubDate>Tue, 28 Apr 2020 00:14:04 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/cli/zsh/</guid><description>
&lt;p>&lt;a href="http://www.zsh.org/">http://www.zsh.org/&lt;/a>&lt;/p>
&lt;h2 id="source-code">Source Code&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://sourceforge.net/p/zsh/code/ci/master/tree/">https://sourceforge.net/p/zsh/code/ci/master/tree/&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/zsh-users/zsh">https://github.com/zsh-users/zsh&lt;/a> &amp;hellip; Mirror&lt;/li>
&lt;/ul>
&lt;h2 id="configuration">Configuration&lt;/h2>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-zsh" data-lang="zsh">&lt;span style="color:#8f5902;font-style:italic"># history -i でコマンドの実行時間表示&lt;/span>
setopt extended_history
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://orumin.blogspot.com/2017/10/unix-os.html">Unix 系 OS でコマンド実行間にタイムスタンプを付ける&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>A: 2020-04-27</title><link>https://progrhy.me/tech-notes/a/memo/20200427/</link><pubDate>Mon, 27 Apr 2020 23:52:42 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/memo/20200427/</guid><description>
&lt;h2 id="427">4/27&lt;/h2>
&lt;h3 id="cloud-build--terraformでインフラcicd">Cloud Build + TerraformでインフラCI/CD&lt;/h3>
&lt;p>参考記事:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://cloud.google.com/solutions/managing-infrastructure-as-code?hl=ja">Terraform、Cloud Build、GitOps を使用してインフラストラクチャをコードとして管理する | ソリューション&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://medium.com/google-cloud/infrastructure-as-code-introduction-to-continuous-spark-cluster-deployment-with-cloud-build-and-9798a776bbb0">Infrastructure as Code: Introduction to Continuous Spark Cluster Deployment with Cloud Build and Terraform&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="bitbucket-pipelines--terraform">Bitbucket Pipelines + Terraform&lt;/h3>
&lt;p>GCP事例が見つからないけど、たぶん行けるのでは。&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.slideshare.net/MasatomoIto/terraform-with-bitbucket-pipeline">Terraform with Bitbucket pipeline&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.nicksantamaria.net/post/self-deploying-site-hugo-terraform-bitbucket-pipelines/">How to build self-deploying applications with Terraform and BitBucket Pipelines. | Nick Santamaria&lt;/a>&lt;/li>
&lt;/ul>
&lt;h4 id="tfnotify対応">tfnotify対応&lt;/h4>
&lt;p>&lt;code>help wanted&lt;/code>&lt;/p>
&lt;p>&lt;a href="https://github.com/mercari/tfnotify/issues/36">Support Bitbucket Pipelines · Issue #36 · mercari/tfnotify&lt;/a>&lt;/p></description></item><item><title>A: Google Kubernetes Engine</title><link>https://progrhy.me/tech-notes/a/gcp/gke/</link><pubDate>Mon, 27 Apr 2020 11:01:49 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/gcp/gke/</guid><description>
&lt;h2 id="documentation">Documentation&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/?hl=ja">https://cloud.google.com/kubernetes-engine/docs/?hl=ja&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://cloud.google.com/kubernetes-engine/quotas?hl=ja">https://cloud.google.com/kubernetes-engine/quotas?hl=ja&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="ベストプラクティス">ベストプラクティス&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://cloud.google.com/solutions/best-practices-for-operating-containers">Best Practices for Operating Containers | Architectures | Google Cloud&lt;/a>
&lt;ul>
&lt;li>Logging, etc.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://cloud.google.com/blog/products/gcp/kubernetes-best-practices-terminating-with-grace">Kubernetes best practices: terminating with grace | Google Cloud Blog&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="仕様">仕様&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/concepts/cluster-autoscaler?hl=ja">クラスタ オートスケーラー | Kubernetes Engine のドキュメント | Google Cloud&lt;/a>
&lt;ul>
&lt;li>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/how-to/cluster-autoscaler?hl=ja">クラスタの自動スケーリング | Kubernetes Engine のドキュメント | Google Cloud&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="quota">Quota&lt;/h3>
&lt;p>&lt;a href="https://cloud.google.com/kubernetes-engine/quotas">https://cloud.google.com/kubernetes-engine/quotas&lt;/a>&lt;/p>
&lt;p>Last updated at 2020-04-13&lt;/p>
&lt;ul>
&lt;li>GKEクラスタごと
&lt;ul>
&lt;li>クラスタあたりの最大ノード数: 5,000&lt;/li>
&lt;li>ノードプールあたりの最大ノード数: 1,000&lt;/li>
&lt;li>ノードあたりの最大ポッド数: 110&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="限定公開クラスタ">限定公開クラスタ&lt;/h3>
&lt;p>Docs:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/how-to/private-clusters?hl=ja">限定公開クラスタの設定 | Kubernetes Engine のドキュメント | Google Cloud&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://cloud.google.com/sdk/gcloud/reference/container/clusters/create?hl=ja">https://cloud.google.com/sdk/gcloud/reference/container/clusters/create?hl=ja&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://cloud.google.com/nat/docs/gke-example">Example GKE Setup | Cloud NAT | Google Cloud&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>要点:&lt;/p>
&lt;ul>
&lt;li>ノードは内部IPアドレスのみを持つため、インターネットから隔離される&lt;/li>
&lt;li>限定公開クラスタでは、マスターへのアクセスを制御できる&lt;/li>
&lt;li>LB経由で受信トラフィックを受けられる。また、内部LB経由でVPC内のトラフィックを受けることもできる&lt;/li>
&lt;li>外と通信したいときは、上記の「Example GKE Setup」にあるように、Cloud NAT + Cloud Routerをセットアップする&lt;/li>
&lt;/ul>
&lt;p>Tips:&lt;/p>
&lt;ul>
&lt;li>(2019-12-02現在) &lt;code>gcloud container clusters create&lt;/code> コマンドでは &lt;code>--enable-private-nodes --master-ipv4-cidr &amp;lt;CIDR&amp;gt;&lt;/code> オプションをつける&lt;/li>
&lt;/ul>
&lt;h3 id="負荷分散">負荷分散&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/concepts/ingress">https://cloud.google.com/kubernetes-engine/docs/concepts/ingress&lt;/a>&lt;/li>
&lt;/ul>
&lt;h4 id="https-負荷分散">HTTP(S) 負荷分散&lt;/h4>
&lt;p>Ingressで複数のバックエンドServiceを設定できる。設定例:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-YAML" data-lang="YAML">&lt;span style="color:#204a87;font-weight:bold">apiVersion&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>extensions/v1beta1&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">kind&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>Ingress&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">metadata&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>my-ingress&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">spec&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">rules&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">http&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">paths&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">path&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>/*&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">backend&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">serviceName&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>my-products&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">servicePort&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">60000&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">path&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>/discounted&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">backend&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">serviceName&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>my-discounted-products&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">servicePort&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">80&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h5 id="managed-ssl-certificateを使う">Managed SSL certificateを使う&lt;/h5>
&lt;p>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/how-to/managed-certs">https://cloud.google.com/kubernetes-engine/docs/how-to/managed-certs&lt;/a>&lt;/p>
&lt;ul>
&lt;li>GCPの静的IPを払い出し、対象のDNSレコードに設定する必要がある&lt;/li>
&lt;/ul>
&lt;p>See also &lt;a href="https://sites.google.com/site/progrhymetechwiki/cloud/gcp/gclb#TOC-SSL-">https://sites.google.com/site/progrhymetechwiki/cloud/gcp/gclb#TOC-SSL-&lt;/a>&lt;/p>
&lt;h5 id="httpの無効化">HTTPの無効化&lt;/h5>
&lt;p>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/concepts/ingress?hl=ja#disabling_http">https://cloud.google.com/kubernetes-engine/docs/concepts/ingress?hl=ja#disabling_http&lt;/a>&lt;/p>
&lt;p>HTTPSのみを使うときはアノテーション &lt;code>kubernetes.io/ingress.allow-http&lt;/code> の値を &lt;code>&amp;quot;false&amp;quot;&lt;/code> に設定する。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-YAML" data-lang="YAML">&lt;span style="color:#204a87;font-weight:bold">apiVersion&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>extensions/v1beta1&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">kind&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>Ingress&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">metadata&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>my-ingress&lt;span style="color:#0000cf;font-weight:bold">-2&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">annotations&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">kubernetes.io/ingress.allow-http&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;false&amp;#34;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">spec&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">tls&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">secretName&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>my-secret&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>...&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>※2020-03-04現在、K8sのバージョンによっては、マネージドSSL証明書を使う場合は、 &lt;code>ingress.gcp.kubernetes.io/pre-shared-cert&lt;/code> アノテーションの値に証明書名を入れる必要がある。1.15.x-gke.y の場合は自動でアノテーション付けてくれるっぽい。&lt;br>
See &lt;a href="https://github.com/kubernetes/ingress-gce/issues/1001">https://github.com/kubernetes/ingress-gce/issues/1001&lt;/a>&lt;/p>
&lt;h3 id="内部tcpudp負荷分散">内部TCP/UDP負荷分散&lt;/h3>
&lt;p>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/how-to/internal-load-balancing?hl=ja">内部 TCP / UDP 負荷分散 | Kubernetes Engine のドキュメント | Google Cloud&lt;/a>&lt;/p>
&lt;p>2020-03-25現在、β版&lt;/p>
&lt;ul>
&lt;li>Serviceを &lt;code>type: LoadBalancer&lt;/code> で作成し、所定のannotationを入れる&lt;/li>
&lt;li>内部LBが作成される&lt;/li>
&lt;li>Ingressは不要&lt;/li>
&lt;li>Compute InstanceGroupで振り分けされる
&lt;ul>
&lt;li>2020-03-25現在、ネットワークエンドポイントグループには対応していない&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>同じDeploymentで、内部LBのServiceと外部HTTP(S)負荷分散用の2つのServiceを持つことができる&lt;/li>
&lt;/ul>
&lt;p>Example:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-YAML" data-lang="YAML">&lt;span style="color:#204a87;font-weight:bold">apiVersion&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>v1&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">kind&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>Service&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">metadata&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>ilb-service&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">annotations&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">cloud.google.com/load-balancer-type&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;Internal&amp;#34;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">labels&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">app&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>hello&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">spec&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">type&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>LoadBalancer&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">selector&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">app&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>hello&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">ports&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">port&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">80&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">targetPort&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">8080&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">protocol&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>TCP&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="backendconfigβ-on-2020-04-27">BackendConfig（β on 2020-04-27）&lt;/h3>
&lt;p>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/concepts/backendconfig?hl=en">https://cloud.google.com/kubernetes-engine/docs/concepts/backendconfig?hl=en&lt;/a>&lt;/p>
&lt;p>GKE固有のcustom resource.&lt;/p>
&lt;p>BackendConfigによって、HTTP(S) Load Balancingに以下の機能を設定できる:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/how-to/cdn-backendconfig">Cloud CDN&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/how-to/cloud-armor-backendconfig">Cloud Armor&lt;/a>&lt;/li>
&lt;li>Identity-Aware Proxy (IAP)&lt;/li>
&lt;li>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/how-to/configure-backend-service">Timeout, Connection draining timeout, Session affinity, User-defined request headers&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>Example:&lt;/p>
&lt;ul>
&lt;li>タイムアウトを40秒に設定&lt;/li>
&lt;li>接続ドレインタイムアウトを60秒に設定&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-YAML" data-lang="YAML">&lt;span style="color:#204a87;font-weight:bold">apiVersion&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>cloud.google.com/v1beta1&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">kind&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>BackendConfig&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">metadata&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>my-bsc-backendconfig&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">spec&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">timeoutSec&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">40&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">connectionDraining&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">drainingTimeoutSec&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">60&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="horizontal-pod-autoscaler">Horizontal Pod Autoscaler&lt;/h3>
&lt;p>HPA.&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/concepts/horizontalpodautoscaler?hl=ja">水平ポッド自動スケーリング | Kubernetes Engine のドキュメント | Google Cloud&lt;/a>
&lt;ul>
&lt;li>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/tutorials/external-metrics-autoscaling?hl=ja">外部指標によるデプロイの自動スケーリング | Kubernetes Engine のチュートリアル | Google Cloud&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/tutorials/custom-metrics-autoscaling?hl=ja">カスタム指標でのデプロイの自動スケーリング | Kubernetes Engine のチュートリアル | Google Cloud&lt;/a>&lt;/li>
&lt;li>いずれもCloud Monitoringメトリクスでスケール設定を行う&lt;/li>
&lt;li>&lt;a href="https://github.com/GoogleCloudPlatform/k8s-stackdriver/tree/master/custom-metrics-stackdriver-adapter">https://github.com/GoogleCloudPlatform/k8s-stackdriver/tree/master/custom-metrics-stackdriver-adapter&lt;/a> をクラスタにデプロイする&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://sites.google.com/site/progrhymetechwiki/software/k8s#TOC-Horizontal-Pod-Autoscaler">https://sites.google.com/site/progrhymetechwiki/software/k8s#TOC-Horizontal-Pod-Autoscaler&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.doit-intl.com/autoscaling-k8s-hpa-with-google-http-s-load-balancer-rps-stackdriver-metric-92db0a28e1ea">Autoscaling K8s HPA with Google HTTP/S Load-Balancer RPS EXTERNAL Stackdriver Metrics&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="how-to">How-to&lt;/h2>
&lt;h3 id="アップグレード">アップグレード&lt;/h3>
&lt;p>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/how-to/upgrading-a-cluster">https://cloud.google.com/kubernetes-engine/docs/how-to/upgrading-a-cluster&lt;/a>&lt;/p>
&lt;p>Tips:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/concepts/release-channels">リリースチャネル&lt;/a>を指定することで、自動アップグレードできる&lt;/li>
&lt;/ul>
&lt;h3 id="kubeconfigエントリを生成">kubeconfigエントリを生成&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">gcloud container clusters get-credentials &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>CLUSTER_NAME&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>--project PROJECT&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>--region REGION&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>↑のコマンドは更に、クラスタをデフォルトのkubectlのcontextに設定する。&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/how-to/cluster-access-for-kubectl?hl=ja">kubectl 用のクラスタ アクセスの構成 | Kubernetes Engine のドキュメント | Google Cloud&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="gkeのノードにssh">GKEのノードにSSH&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://cloud.google.com/compute/docs/instances/connecting-advanced#sshbetweeninstances">高度な方法によるインスタンスへの接続 | Compute Engine ドキュメント | Google Cloud&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://qiita.com/inductor/items/bc0ff7d761e0cc7e9394">限定公開クラスターのGKEノードにサクッとSSHする方法 - Qiita&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://qiita.com/sonots/items/6e2a57af945cf0daedd4">GKE で k8s クラスタの node に ssh する - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://acloud.guru/forums/gcp-certified-associate-cloud-engineer/discussion/-Lh3ET0aNrv3FwNbNvh6/Insufficient%20Permission:%20Request%20had%20insufficient%20authentication%20scopes.">Insufficient Permission: Request had insufficient authentication scopes. - Course: Google Certified Associate Cloud Engineer 2020&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="コンテナネイティブの負荷分散を使う">コンテナネイティブの負荷分散を使う&lt;/h3>
&lt;p>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/how-to/container-native-load-balancing?hl=ja">コンテナ ネイティブの負荷分散を使用する | Kubernetes Engine のドキュメント | Google Cloud&lt;/a>&lt;/p>
&lt;p>TL;DR:&lt;/p>
&lt;ul>
&lt;li>ネットワークエンドポイントグループ(NEG)を作成して、Podに均等にトラフィックを分配できる&lt;/li>
&lt;li>従来の方式だとインスタンスグループ経由のアクセスで、iptablesを介してPodにアクセスしており、余分なネットワークオーバーヘッドが発生していた&lt;/li>
&lt;/ul>
&lt;p>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/how-to/container-native-load-balancing#known_issues">既知の問題&lt;/a>（2020-04-27時点）:&lt;/p>
&lt;ul>
&lt;li>GKEのガベージコレクションが2分間隔なので、LBが完全に削除される前にクラスタが削除された場合、NEGを手動で削除する必要がある&lt;/li>
&lt;li>&lt;a href="https://cloud.google.com/kubernetes-engine/docs/concepts/container-native-load-balancing#pod_readiness">Podのreadinessフィードバック&lt;/a>を&lt;u>使っていない場合&lt;/u>、ワークロードをデプロイするときや再起動するときに、ワークロードの更新完了に要する時間よりも、新しいエンドポイントの伝播に要する時間のほうが長くなる場合がある&lt;/li>
&lt;/ul>
&lt;h2 id="topics">Topics&lt;/h2>
&lt;h3 id="logging">Logging&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://cloud.google.com/solutions/customizing-stackdriver-logs-fluentd?hl=ja">Google Kubernetes Engine の Stackdriver ログを Fluentd でカスタマイズする | ソリューション&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="参考">参考&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://medium.com/@rshimma/rails-on-gke-with-stackdriver-logging-63163c72934">GKE上RailsのアプリケーションログをStackdriver Loggingで運用する方法 - Riki Shimma - Medium&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>A: Cloud Load Balancing</title><link>https://progrhy.me/tech-notes/a/gcp/lb/</link><pubDate>Mon, 27 Apr 2020 10:48:40 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/gcp/lb/</guid><description>
&lt;h2 id="documentation">Documentation&lt;/h2>
&lt;p>&lt;a href="https://cloud.google.com/load-balancing/docs/">https://cloud.google.com/load-balancing/docs/&lt;/a>&lt;/p>
&lt;h2 id="概要">概要&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://cloud.google.com/load-balancing/docs/https/?hl=ja">HTTP(S) 負荷分散のコンセプト | 負荷分散 | Google Cloud&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://cloud.google.com/load-balancing/docs/backend-service?hl=ja">バックエンド サービスについて | 負荷分散 | Google Cloud&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="spec">Spec&lt;/h2>
&lt;ul>
&lt;li>IP anycast対応&lt;/li>
&lt;li>アーキテクチャ:
&lt;ul>
&lt;li>&lt;a href="https://cloud.google.com/solutions/about-capacity-optimization-with-global-lb?hl=ja">グローバル負荷分散によるアプリケーションの処理能力の改善 | アーキテクチャ | Google Cloud&lt;/a> &amp;hellip; IP anycast, GFE&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="ssl証明書">SSL証明書&lt;/h3>
&lt;p>&lt;a href="https://cloud.google.com/load-balancing/docs/ssl-certificates">https://cloud.google.com/load-balancing/docs/ssl-certificates&lt;/a>&lt;/p>
&lt;ul>
&lt;li>マネージド証明書
&lt;ul>
&lt;li>Let&amp;rsquo;s Encrypt&lt;/li>
&lt;li>DV&lt;/li>
&lt;li>自動更新&lt;/li>
&lt;li>ワイルドカードドメインは不可&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="接続ドレイン">接続ドレイン&lt;/h3>
&lt;p>&lt;a href="https://cloud.google.com/load-balancing/docs/enabling-connection-draining?hl=ja">コネクション ドレインの有効化 | 負荷分散 | Google Cloud&lt;/a>&lt;/p>
&lt;p>コネクションドレインとも表記される。（公式ドキュメント統一してくれ）&lt;/p>
&lt;blockquote>
&lt;p>コネクション ドレインとは、VM がインスタンス グループから除外されたときに、既存の進行中リクエストに完了までの時間が確実に与えられるようにするプロセスです。&lt;/p>
&lt;p>コネクション ドレインを有効にするには、バックエンド サービスでコネクション ドレイン タイムアウトを設定します。タイムアウト時間は 1～3,600 秒に設定してください。&lt;/p>
&lt;/blockquote>
&lt;p>デフォルトONでいいんじゃないかと思うのだが、2020-04-27現在は、上記のように設定が必要。&lt;/p>
&lt;p>次のLBのバックエンドサービスで使える:&lt;/p>
&lt;ul>
&lt;li>HTTP(S) ロードバランサ&lt;/li>
&lt;li>TCP プロキシ ロードバランサ&lt;/li>
&lt;li>SSL プロキシ ロードバランサ&lt;/li>
&lt;li>内部 HTTP(S) ロードバランサ&lt;/li>
&lt;li>内部 TCP / UDP ロードバランサ&lt;/li>
&lt;/ul>
&lt;h2 id="外部https負荷分散">外部HTTP(S)負荷分散&lt;/h2>
&lt;h3 id="バックエンドバケット">バックエンドバケット&lt;/h3>
&lt;p>&lt;a href="https://cloud.google.com/load-balancing/docs/https/adding-backend-buckets-to-load-balancers?hl=ja">ロードバランサへの Cloud Storage バケットの追加 | 負荷分散 | Google Cloud&lt;/a>&lt;/p>
&lt;p>Cloud Storageバケットをバックエンドに追加し、パスで振り分けることができる。&lt;/p>
&lt;h2 id="logging">Logging&lt;/h2>
&lt;p>&lt;a href="https://cloud.google.com/load-balancing/docs/https/https-logging-monitoring?hl=ja">HTTP(S) 負荷分散のロギングとモニタリング | Google Cloud&lt;/a>&lt;/p>
&lt;h2 id="topics">Topics&lt;/h2>
&lt;h3 id="gclbとcdnによる動的サイト高速化">GCLBとCDNによる動的サイト高速化&lt;/h3>
&lt;p>&lt;a href="https://cloud.google.com/solutions/about-capacity-optimization-with-global-lb?hl=ja">グローバル負荷分散によるアプリケーションの処理能力の改善 | アーキテクチャ | Google Cloud&lt;/a>にあるように、GCLBを前段に置いたサービスでは、GFEによるネットワーク経路最適化やTLS終端の恩恵を得られる。&lt;br>
従って、APIの&lt;a href="https://docs.microsoft.com/ja-jp/azure/cdn/cdn-dynamic-site-acceleration">動的サイト高速化&lt;/a>をねらいとしてCDNを入れる意味は薄い。&lt;br>
特に、全くキャッシュをしない場合、CDNを入れても入れなくてもほとんど変わらない、とGoogle Cloudの中の人が言っていた。（無意味ではないけど、ネットワークのゆらぎぐらいの差らしい）&lt;/p></description></item><item><title>A: AWS</title><link>https://progrhy.me/tech-notes/a/software/terraform/provider/aws/</link><pubDate>Sun, 26 Apr 2020 23:20:34 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/software/terraform/provider/aws/</guid><description>
&lt;h2 id="provider-configuration">Provider Configuration&lt;/h2>
&lt;ul>
&lt;li>&lt;code>max_retries&lt;/code> &amp;hellip; APIのリトライ回数を指定できる&lt;/li>
&lt;/ul>
&lt;h2 id="data-sources">Data Sources&lt;/h2>
&lt;h3 id="acm_certificate">acm_certificate&lt;/h3>
&lt;p>&lt;a href="https://www.terraform.io/docs/providers/aws/d/acm_certificate.html">https://www.terraform.io/docs/providers/aws/d/acm_certificate.html&lt;/a>&lt;/p>
&lt;p>ACM証明書の情報取得&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://dev.classmethod.jp/cloud/aws/terraform-supports-acm-data-source-in-v-0-7-9/" title="Terraform v0.7.9 でACMのデータソースが導入されました ｜ Developers.IO">Terraform v0.7.9 でACMのデータソースが導入されました ｜ Developers.IO&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://cross-black777.hatenablog.com/entry/2016/11/17/231733" title="ACMで取得した証明書をterraformで配置する - tjinjin's blog">ACMで取得した証明書をterraformで配置する - tjinjin&amp;rsquo;s blog&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="caller_identity">caller_identity&lt;/h3>
&lt;p>&lt;a href="https://www.terraform.io/docs/providers/aws/d/caller_identity.html">https://www.terraform.io/docs/providers/aws/d/caller_identity.html&lt;/a>&lt;/p>
&lt;p>Terraform実行中のAWSアカウントのID等の情報を取得する。&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://qiita.com/gongo/items/a2b83d7402b97ef43574" title="*.tf 内で AWS アカウント ID を自動参照(取得)する aws_caller_identity Data Source - Qiita">*.tf 内で AWS アカウント ID を自動参照(取得)する aws_caller_identity Data Source - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="iam_policy_document">iam_policy_document&lt;/h3>
&lt;p>&lt;a href="https://www.terraform.io/docs/providers/aws/d/iam_policy_document.html">https://www.terraform.io/docs/providers/aws/d/iam_policy_document.html&lt;/a>&lt;/p>
&lt;p>IAM PolicyのJSONをHCLっぽく定義できる。&lt;br>
JSONテンプレートより融通が効くし、syntax checkも掛かるので、便利なことがある。&lt;/p>
&lt;h3 id="region">region&lt;/h3>
&lt;p>&lt;a href="https://www.terraform.io/docs/providers/aws/d/region.html">https://www.terraform.io/docs/providers/aws/d/region.html&lt;/a>&lt;/p>
&lt;p>&lt;code>provider&lt;/code> で設定したリージョンを取得できる。&lt;/p>
&lt;h3 id="sns_topic">sns_topic&lt;/h3>
&lt;p>&lt;a href="https://www.terraform.io/docs/providers/aws/d/sns_topic.html">https://www.terraform.io/docs/providers/aws/d/sns_topic.html&lt;/a>&lt;/p>
&lt;p>SNS TopicのARNを取得できる。&lt;/p>
&lt;h3 id="ssm_parameter">ssm_parameter&lt;/h3>
&lt;p>&lt;a href="https://www.terraform.io/docs/providers/aws/d/ssm_parameter.html">https://www.terraform.io/docs/providers/aws/d/ssm_parameter.html&lt;/a>&lt;/p>
&lt;p>EC2 Parameter Storeからデータ取得&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-terraform" data-lang="terraform">&lt;span style="color:#8f5902;font-style:italic"># &amp;#34;foo&amp;#34;という名前のパラメータストアを取得
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">data&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;aws_ssm_parameter&amp;#34;&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;foo&amp;#34;&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#c4a000">name&lt;/span> = &lt;span style="color:#4e9a06">&amp;#34;foo&amp;#34;&lt;/span>
&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>SecureString&lt;/code> であっても特にKSM keyを指定する必要はない。内部的にdecryptしてくれるみたい。
&lt;ul>
&lt;li>&amp;ldquo;terraformのstateの中ではraw textで保存されるから気をつけてね&amp;quot;って書いてある。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://ymmtmsys.hatenablog.com/entry/2017/06/28/000822" title="terraform と パラメータストア - yBlog">terraform と パラメータストア - yBlog&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://aws.amazon.com/jp/ec2/systems-manager/parameter-store/">https://aws.amazon.com/jp/ec2/systems-manager/parameter-store/&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="resources">Resources&lt;/h2>
&lt;h3 id="appautoscaling関連">appautoscaling関連&lt;/h3>
&lt;p>Application AutoScaling.&lt;br>
ECS Serviceなどのオートスケール設定。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/appautoscaling_policy.html">https://www.terraform.io/docs/providers/aws/r/appautoscaling_policy.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/appautoscaling_target.html">https://www.terraform.io/docs/providers/aws/r/appautoscaling_target.html&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="autoscaling関連">autoscaling関連&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/autoscaling_group.html">https://www.terraform.io/docs/providers/aws/r/autoscaling_group.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/launch_configuration.html">https://www.terraform.io/docs/providers/aws/r/launch_configuration.html&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="cloudwatch関連">cloudwatch関連&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/cloudwatch_log_group.html">https://www.terraform.io/docs/providers/aws/r/cloudwatch_log_group.html&lt;/a>
&lt;ul>
&lt;li>&lt;code>retention_in_days&lt;/code> &amp;hellip; ログの保持期間。とり得る値は &lt;a href="http://docs.aws.amazon.com/ja_jp/AmazonCloudWatchLogs/latest/APIReference/API_PutRetentionPolicy.html">http://docs.aws.amazon.com/ja_jp/AmazonCloudWatchLogs/latest/APIReference/API_PutRetentionPolicy.html&lt;/a> に示されている。 &lt;code>0&lt;/code> を指定すると無期限になる。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/cloudwatch_log_subscription_filter.html">https://www.terraform.io/docs/providers/aws/r/cloudwatch_log_subscription_filter.html&lt;/a>
&lt;ul>
&lt;li>ElasticsearchやKinesisにサブスクライブするやつ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/cloudwatch_metric_alarm.html">https://www.terraform.io/docs/providers/aws/r/cloudwatch_metric_alarm.html&lt;/a>
&lt;ul>
&lt;li>CloudWatch Alarmによる監視の作成&lt;/li>
&lt;li>namespaceに指定する値は &lt;a href="https://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/monitoring/aws-namespaces.html">https://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/monitoring/aws-namespaces.html&lt;/a> を参照。&lt;/li>
&lt;li>各namespaceで有効なmetric_nameやdimentionsフィールドの名前もAWSドキュメントを参照する。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/cloudwatch_event_rule.html">https://www.terraform.io/docs/providers/aws/r/cloudwatch_event_rule.html&lt;/a>
&lt;ul>
&lt;li>&lt;code>schedule_expression&lt;/code> の書式は &lt;a href="http://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/events/ScheduledEvents.html">http://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/events/ScheduledEvents.html&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/cloudwatch_event_target.html">https://www.terraform.io/docs/providers/aws/r/cloudwatch_event_target.html&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="ec2関連">ec2関連&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/ami.html">https://www.terraform.io/docs/providers/aws/r/ami.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/ebs_volume.html">https://www.terraform.io/docs/providers/aws/r/ebs_volume.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/eip.html">https://www.terraform.io/docs/providers/aws/r/eip.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/instance.html">https://www.terraform.io/docs/providers/aws/r/instance.html&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="ecs関連">ecs関連&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/ecr_repository.html">https://www.terraform.io/docs/providers/aws/r/ecr_repository.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/ecr_repository_policy.html">https://www.terraform.io/docs/providers/aws/r/ecr_repository_policy.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/ecs_cluster.html">https://www.terraform.io/docs/providers/aws/r/ecs_cluster.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/ecs_service.html">https://www.terraform.io/docs/providers/aws/r/ecs_service.html&lt;/a>
&lt;ul>
&lt;li>&lt;code>placement_strategy&lt;/code> &amp;hellip; ECSタスク配置戦略。See &lt;a href="https://docs.aws.amazon.com/ja_jp/AmazonECS/latest/developerguide/task-placement-strategies.html">https://docs.aws.amazon.com/ja_jp/AmazonECS/latest/developerguide/task-placement-strategies.html&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/ecs_task_definition.html">https://www.terraform.io/docs/providers/aws/r/ecs_task_definition.html&lt;/a>
&lt;ul>
&lt;li>指定可能なパラメーターについては、&lt;a href="https://docs.aws.amazon.com/ja_jp/AmazonECS/latest/developerguide/task_definition_parameters.html" title="タスク定義パラメーター - Amazon Elastic Container Service">タスク定義パラメーター - Amazon Elastic Container Service&lt;/a> を参照。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>動的ポートマッピングをする場合、task_definitionでhostPortを0にする:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-HCL" data-lang="HCL">&lt;span style="color:#8f5902;font-style:italic"># ecs_task_definition.tf
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">resource&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;aws_ecs_task_definition&amp;#34; &amp;#34;service&amp;#34;&lt;/span> {
&lt;span style="color:#a40000">:&lt;/span>
&lt;span style="color:#000"> container_definitions&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;${file(&amp;#34;task-definitions/service.json&amp;#34;)}&amp;#34;&lt;/span>
&lt;span style="color:#a40000">:&lt;/span>
}&lt;span style="color:#8f5902;font-style:italic">
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">
&lt;/span>&lt;span style="color:#8f5902;font-style:italic"># task_definitions/service.json
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>
{
&lt;span style="color:#a40000">:&lt;/span>
&lt;span style="color:#4e9a06">&amp;#34;portMappings&amp;#34;&lt;/span>&lt;span style="color:#a40000">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>
{
&lt;span style="color:#4e9a06">&amp;#34;containerPort&amp;#34;&lt;/span>&lt;span style="color:#a40000">:&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">3000&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#4e9a06">&amp;#34;hostPort&amp;#34;&lt;/span>&lt;span style="color:#a40000">:&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000;font-weight:bold">]&lt;/span>
}&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#a40000">:&lt;/span>
&lt;span style="color:#000;font-weight:bold">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://qiita.com/joker1007/items/c44a443036439ce535b4" title="terraformで開発者個人別に自由にECSにコンテナをデプロイできる開発環境を用意する - Qiita">terraformで開発者個人別に自由にECSにコンテナをデプロイできる開発環境を用意する - Qiita&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.slideshare.net/SatoshiHirayama/terraformecsecr" title="TerraformでECS+ECRする話">TerraformでECS+ECRする話&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="elasticsearch関連">elasticsearch関連&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/elasticsearch_domain.html">https://www.terraform.io/docs/providers/aws/r/elasticsearch_domain.html&lt;/a>
&lt;ul>
&lt;li>Exported Attributes:
&lt;ul>
&lt;li>&lt;code>domain_id&lt;/code> &amp;hellip; &lt;code>${AWSアカウントID}/${クラスタ名}&lt;/code> . 監視のdimentionとしてはそのままでは使えない。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/elasticsearch_domain_policy.html">https://www.terraform.io/docs/providers/aws/r/elasticsearch_domain_policy.html&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="iam関連">iam関連&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/iam_access_key.html">https://www.terraform.io/docs/providers/aws/r/iam_access_key.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/iam_group.html">https://www.terraform.io/docs/providers/aws/r/iam_group.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/iam_group_policy_attachment.html">https://www.terraform.io/docs/providers/aws/r/iam_group_policy_attachment.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/iam_instance_profile.html">https://www.terraform.io/docs/providers/aws/r/iam_instance_profile.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/iam_policy.html">https://www.terraform.io/docs/providers/aws/r/iam_policy.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/iam_role.html">https://www.terraform.io/docs/providers/aws/r/iam_role.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/iam_role_policy.html">https://www.terraform.io/docs/providers/aws/r/iam_role_policy.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/iam_user.html">https://www.terraform.io/docs/providers/aws/r/iam_user.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/iam_user_policy.html">https://www.terraform.io/docs/providers/aws/r/iam_user_policy.html&lt;/a> &amp;hellip; 当該IAM Userにだけつけるインラインポリシー&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/iam_user_policy_attachment.html">https://www.terraform.io/docs/providers/aws/r/iam_user_policy_attachment.html&lt;/a>&lt;/li>
&lt;li>policyとroleの紐付け
&lt;ul>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/iam_policy_attachment.html">https://www.terraform.io/docs/providers/aws/r/iam_policy_attachment.html&lt;/a>
&lt;ul>
&lt;li>policy : roleが1対多。コード化されていないroleへの紐付けは削除される。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/iam_role_policy_attachment.html">https://www.terraform.io/docs/providers/aws/r/iam_role_policy_attachment.html&lt;/a>
&lt;ul>
&lt;li>policy : roleが1対1.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="kms関連">kms関連&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/kms_alias.html">https://www.terraform.io/docs/providers/aws/r/kms_alias.html&lt;/a> &amp;hellip; alias for KMS key&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/kms_key.html">https://www.terraform.io/docs/providers/aws/r/kms_key.html&lt;/a> &amp;hellip; KMS master keyの作成・管理&lt;/li>
&lt;/ul>
&lt;h3 id="lambda関連">lambda関連&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/lambda_function.html">https://www.terraform.io/docs/providers/aws/r/lambda_function.html&lt;/a>
&lt;ul>
&lt;li>runtime &amp;hellip; 利用できるruntimeについては &lt;a href="https://docs.aws.amazon.com/ja_jp/lambda/latest/dg/API_CreateFunction.html#SSS-CreateFunction-request-Runtime" title="CreateFunction - AWS Lambda">CreateFunction - AWS Lambda&lt;/a> を見る。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/lambda_permission.html">https://www.terraform.io/docs/providers/aws/r/lambda_permission.html&lt;/a>
&lt;ul>
&lt;li>マネジメントコンソールだと&amp;quot;Triggers&amp;quot;のタブ&lt;/li>
&lt;li>許可したリソースからLambdaを実行することができる&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="lb関連">lb関連&lt;/h3>
&lt;p>ALB等の作成・管理:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/lb.html">https://www.terraform.io/docs/providers/aws/r/lb.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/lb_listener.html">https://www.terraform.io/docs/providers/aws/r/lb_listener.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/lb_target_group.html">https://www.terraform.io/docs/providers/aws/r/lb_target_group.html&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>CLB:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/elb.html">https://www.terraform.io/docs/providers/aws/r/elb.html&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="rds関連">rds関連&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/db_event_subscription.html">https://www.terraform.io/docs/providers/aws/r/db_event_subscription.html&lt;/a> &amp;hellip; RDSイベント通知&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/rds_cluster.html">https://www.terraform.io/docs/providers/aws/r/rds_cluster.html&lt;/a> &amp;hellip; Aurora用(?)&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/rds_cluster_instance.html">https://www.terraform.io/docs/providers/aws/r/rds_cluster_instance.html&lt;/a> &amp;hellip; Aurora用(?)&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/db_instance.html">https://www.terraform.io/docs/providers/aws/r/db_instance.html&lt;/a>&lt;/li>
&lt;li>~~&lt;a href="https://www.terraform.io/docs/providers/aws/r/db_subnet_group.html~~">https://www.terraform.io/docs/providers/aws/r/db_subnet_group.html~~&lt;/a> &amp;hellip; これはEC2 Classic用でもう使うことはなさそう。&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/db_security_group.html">https://www.terraform.io/docs/providers/aws/r/db_security_group.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/rds_cluster_parameter_group.html">https://www.terraform.io/docs/providers/aws/r/rds_cluster_parameter_group.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/db_parameter_group.html">https://www.terraform.io/docs/providers/aws/r/db_parameter_group.html&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="route53関連">route53関連&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/route53_zone.html">https://www.terraform.io/docs/providers/aws/r/route53_zone.html&lt;/a>
&lt;ul>
&lt;li>&lt;code>vpc_id&lt;/code> を指定するとPrivate Hosted Zoneになる。&lt;/li>
&lt;li>&lt;code>delegation_set_id&lt;/code> を指定するとPublic Hosted Zoneになる。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/route53_record.html">https://www.terraform.io/docs/providers/aws/r/route53_record.html&lt;/a>
&lt;ul>
&lt;li>Route53のDNSレコード作成・管理&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="s3関連">s3関連&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/s3_bucket.html">https://www.terraform.io/docs/providers/aws/r/s3_bucket.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/s3_bucket_policy.html">https://www.terraform.io/docs/providers/aws/r/s3_bucket_policy.html&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="sns関連">sns関連&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/sns_topic.html">https://www.terraform.io/docs/providers/aws/r/sns_topic.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/sns_topic_policy.html">https://www.terraform.io/docs/providers/aws/r/sns_topic_policy.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/sns_topic_subscription.html">https://www.terraform.io/docs/providers/aws/r/sns_topic_subscription.html&lt;/a>
&lt;ul>
&lt;li>※emailのサブスクリプションは作成できない。メール認証が必要なので。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="vpc関連">vpc関連&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/default_route_table.html">https://www.terraform.io/docs/providers/aws/r/default_route_table.html&lt;/a>
&lt;ul>
&lt;li>これはimportに対応していない&lt;/li>
&lt;li>route_table + main_route_table_associationで代替できそう&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/main_route_table_assoc.html">https://www.terraform.io/docs/providers/aws/r/main_route_table_assoc.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/route.html">https://www.terraform.io/docs/providers/aws/r/route.html&lt;/a>
&lt;ul>
&lt;li>route_tableと一緒に使うとまずそう&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/route_table.html">https://www.terraform.io/docs/providers/aws/r/route_table.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/subnet.html">https://www.terraform.io/docs/providers/aws/r/subnet.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/aws/r/vpc.html">https://www.terraform.io/docs/providers/aws/r/vpc.html&lt;/a>
&lt;ul>
&lt;li>Route 53のPrivate DNSを使うには、 &lt;code>enable_dns_hostnames&lt;/code>, &lt;code>enable_dns_support&lt;/code> を &lt;code>true&lt;/code> にする。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="budgets_budget">budgets_budget&lt;/h3>
&lt;p>&lt;a href="https://www.terraform.io/docs/providers/aws/r/budgets_budget.html">https://www.terraform.io/docs/providers/aws/r/budgets_budget.html&lt;/a>&lt;/p>
&lt;p>Budgetにコストアラートを設定できたり。&lt;/p>
&lt;h3 id="dynamodb_table">dynamodb_table&lt;/h3>
&lt;p>&lt;a href="https://www.terraform.io/docs/providers/aws/r/dynamodb_table.html">https://www.terraform.io/docs/providers/aws/r/dynamodb_table.html&lt;/a>&lt;/p>
&lt;p>DynamoDB table作成&lt;/p>
&lt;h3 id="security_group">security_group&lt;/h3>
&lt;p>&lt;a href="https://www.terraform.io/docs/providers/aws/r/security_group.html">https://www.terraform.io/docs/providers/aws/r/security_group.html&lt;/a>&lt;/p>
&lt;p>Security Groupの作成・管理&lt;/p>
&lt;h3 id="sqs_queue">sqs_queue&lt;/h3>
&lt;p>&lt;a href="https://www.terraform.io/docs/providers/aws/r/sqs_queue.html">https://www.terraform.io/docs/providers/aws/r/sqs_queue.html&lt;/a>&lt;/p>
&lt;p>SQS Queueの作成・管理&lt;/p>
&lt;h3 id="ssm_parameter-1">ssm_parameter&lt;/h3>
&lt;p>&lt;a href="https://www.terraform.io/docs/providers/aws/r/ssm_parameter.html">https://www.terraform.io/docs/providers/aws/r/ssm_parameter.html&lt;/a>&lt;/p>
&lt;p>EC2 Parameter Storeにデータを保存する。&lt;/p></description></item><item><title>A: Google</title><link>https://progrhy.me/tech-notes/a/software/terraform/provider/google/</link><pubDate>Sun, 26 Apr 2020 23:20:30 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/software/terraform/provider/google/</guid><description>
&lt;h2 id="resources">Resources&lt;/h2>
&lt;h3 id="compute系">compute系&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/google/r/compute_backend_bucket.html">google_compute_backend_bucket&lt;/a> &amp;hellip; HTTP(S) LBのバックエンドになるGCSバケット設定&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/google/r/compute_backend_service.html">google_compute_backend_service&lt;/a> &amp;hellip; GCLBのバックエンドになるサービスの設定&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/google/r/compute_health_check.html">google_compute_health_check&lt;/a> &amp;hellip; ヘルスチェック&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/google/r/compute_managed_ssl_certificate.html">google_compute_managed_ssl_certificate&lt;/a> &amp;hellip; β (2020-03-18) HTTPS LBのためのマネージドTLS証明書&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/google/r/compute_security_policy.html">google_compute_security_policy&lt;/a> &amp;hellip; Cloud Armorのセキュリティポリシー&lt;/li>
&lt;/ul>
&lt;h3 id="storage-gcs-系">storage (GCS) 系&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/google/r/storage_bucket.html">google_storage_bucket&lt;/a> &amp;hellip; GCS (Cloud Storage) バケット&lt;/li>
&lt;li>&lt;a href="https://www.terraform.io/docs/providers/google/r/storage_bucket_object.html">google_storage_bucket_object&lt;/a> &amp;hellip; GCSオブジェクト。ローカルのファイルからアップロードできる&lt;/li>
&lt;/ul>
&lt;h3 id="google_cloudfunctions_function">google_cloudfunctions_function&lt;/h3>
&lt;p>&lt;a href="https://www.terraform.io/docs/providers/google/r/cloudfunctions_function.html">https://www.terraform.io/docs/providers/google/r/cloudfunctions_function.html&lt;/a>&lt;/p>
&lt;p>Cloud Function作成・管理&lt;/p>
&lt;h3 id="google_project_service">google_project_service&lt;/h3>
&lt;p>&lt;a href="https://www.terraform.io/docs/providers/google/r/google_project_service.html">https://www.terraform.io/docs/providers/google/r/google_project_service.html&lt;/a>&lt;/p>
&lt;p>APIサービスの有効化&lt;/p></description></item><item><title>A: v0.11</title><link>https://progrhy.me/tech-notes/a/software/terraform/config/v0.11/</link><pubDate>Sun, 26 Apr 2020 23:09:11 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/software/terraform/config/v0.11/</guid><description>
&lt;h2 id="便利構文">便利構文&lt;/h2>
&lt;p>&lt;a href="https://www.terraform.io/docs/configuration/interpolation.html">https://www.terraform.io/docs/configuration/interpolation.html&lt;/a>&lt;/p>
&lt;p>計算とか制御構文とか便利関数が有る。&lt;/p>
&lt;h3 id="elementlist-index">element(list, index)&lt;/h3>
&lt;p>listの要素を取得。&lt;br>
最初の要素のindexは0.&lt;/p>
&lt;h3 id="filepath">file(path)&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-hcl" data-lang="hcl">&lt;span style="color:#000">content&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;${file(path/to/file)}&amp;#34;&lt;/span>&lt;span style="color:#8f5902;font-style:italic"> # ファイルの内容を取り込む
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="formatformat-args-">format(format, args, &amp;hellip;)&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-hcl" data-lang="hcl">&lt;span style="color:#000">url&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;${format(&amp;#34;https://%s/%s&amp;#34;, var.fqdn, var.path)}&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="formatlistformat-args-">formatlist(format, args, &amp;hellip;)&lt;/h3>
&lt;p>formatのlist版。 &lt;code>args...&lt;/code> としてlistを受け取り、list値を返す。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-hcl" data-lang="hcl">&lt;span style="color:#000">urls&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;${formatlist(&amp;#34;https://%s/&amp;#34;, var.fqdn_list)}&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="lookupmap-key--default">lookup(map, key [, default])&lt;/h3>
&lt;p>mapの &lt;code>key&lt;/code> に対するvalueを参照する。第3引数に見つからなかったときの &lt;code>default&lt;/code> 値を指定することもできる。&lt;/p>
&lt;p>1階層のmapは &lt;code>stash[&amp;quot;x&amp;quot;]&lt;/code> で良いが、デフォルト値を設定したいときや、2階層のmapでは &lt;code>lookup&lt;/code> を使う必要がある。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-hcl" data-lang="hcl">&lt;span style="color:#000">v&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;${lookup(var.stash[&amp;#34;x&amp;#34;], &amp;#34;y&amp;#34;, &amp;#34;default-value&amp;#34;)}&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="keysmap">keys(map)&lt;/h3>
&lt;p>mapのキーをソート済みのlistとして返す。See also &lt;code>values&lt;/code>&lt;/p>
&lt;h3 id="mapkey-value-">map(key, value, &amp;hellip;)&lt;/h3>
&lt;p>mapを作る。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-hcl" data-lang="hcl">&lt;span style="color:#204a87;font-weight:bold">output&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;result&amp;#34;&lt;/span> {
&lt;span style="color:#000"> value&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#a40000">&amp;#34;&lt;/span>&lt;span style="color:#4e9a06">${&lt;/span>&lt;span style="color:#a40000">map&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>
&lt;span style="color:#4e9a06">&amp;#34;key-1&amp;#34;, &amp;#34;${value-1}&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#4e9a06">&amp;#34;key-2&amp;#34;, &amp;#34;${value-2}&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#a40000">:&lt;/span>
&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#4e9a06">}&lt;/span>&lt;span style="color:#a40000">&amp;#34;&lt;/span>
}
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="splitdelim-string">split(delim, string)&lt;/h3>
&lt;p>文字列をデリミタ文字で分割してlistを返す。&lt;/p>
&lt;p>Example:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-hcl" data-lang="hcl">&lt;span style="color:#4e9a06">&amp;#34;${element(split(&amp;#34;/&amp;#34;, &amp;#34;dir/file&amp;#34;), 1)}&amp;#34; #=&amp;gt; &amp;#34;file&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="valuesmap">values(map)&lt;/h3>
&lt;p>mapの値をlistとして返す。得られる値の順序は、対応するキーのlistが &lt;code>keys&lt;/code> で返される順序と同じになるようである。&lt;/p></description></item><item><title>A: npm</title><link>https://progrhy.me/tech-notes/a/program/lang/js/node/npm/</link><pubDate>Sun, 26 Apr 2020 21:03:40 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/program/lang/js/node/npm/</guid><description>
&lt;h2 id="documentation">Documentation&lt;/h2>
&lt;p>&lt;a href="https://docs.npmjs.com/">https://docs.npmjs.com/&lt;/a>&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://docs.npmjs.com/cli-documentation/">CLI documentation | npm Documentation&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="cli">CLI&lt;/h2>
&lt;p>Examples:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">&lt;span style="color:#8f5902;font-style:italic"># help&lt;/span>
npm &lt;span style="color:#204a87">help&lt;/span>
npm &lt;span style="color:#204a87">help&lt;/span> &amp;lt;command&amp;gt;
&lt;span style="color:#8f5902;font-style:italic"># バージョン表示&lt;/span>
npm -v
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="npm-install">npm-install&lt;/h3>
&lt;p>&lt;a href="https://docs.npmjs.com/cli-commands/install.html">https://docs.npmjs.com/cli-commands/install.html&lt;/a>&lt;/p>
&lt;p>パッケージをインストールする。&lt;/p>
&lt;p>エイリアス: &lt;code>i, add&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">&lt;span style="color:#8f5902;font-style:italic"># 書式&lt;/span>
npm install パッケージ &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>OPTIONS&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span>
npm install &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>&amp;lt;@scope&amp;gt;/&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span>&amp;lt;name&amp;gt;
npm install &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>&amp;lt;@scope&amp;gt;/&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span>&amp;lt;name&amp;gt;@&amp;lt;version&amp;gt;
&lt;span style="color:#8f5902;font-style:italic"># package.json に従ってインストール&lt;/span>
npm install
&lt;/code>&lt;/pre>&lt;/div>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Option&lt;/th>
&lt;th>説明&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>-g&lt;/td>
&lt;td>&amp;ndash;global&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;no-save&lt;/td>
&lt;td>（package.jsonの）&lt;strong>dependencies&lt;/strong> に追加しない&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="npm-ls">npm-ls&lt;/h3>
&lt;p>&lt;a href="https://docs.npmjs.com/cli-commands/ls.html">https://docs.npmjs.com/cli-commands/ls.html&lt;/a>&lt;/p>
&lt;p>インストールされたパッケージを一覧表示。&lt;/p>
&lt;p>エイリアス: &lt;code>list, la, ll&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">npm ls &lt;span style="color:#ce5c00;font-weight:bold">[[&lt;/span>&amp;lt;@scope&amp;gt;/&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span>&amp;lt;pkg&amp;gt; ...&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="npm-uninstall">npm-uninstall&lt;/h3>
&lt;p>&lt;a href="https://docs.npmjs.com/cli-commands/uninstall.html">https://docs.npmjs.com/cli-commands/uninstall.html&lt;/a>&lt;/p>
&lt;p>インストールされたパッケージを削除する。&lt;/p>
&lt;p>エイリアス: &lt;code>remove, rm, un, unlink&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">npm uninstall パッケージ &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>OPTIONS&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>A: Install</title><link>https://progrhy.me/tech-notes/a/program/lang/go/install/</link><pubDate>Sun, 26 Apr 2020 19:02:34 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/program/lang/go/install/</guid><description>
&lt;h2 id="ubuntu">Ubuntu&lt;/h2>
&lt;p>&lt;a href="https://github.com/golang/go/wiki/Ubuntu">https://github.com/golang/go/wiki/Ubuntu&lt;/a>&lt;/p>
&lt;p>2018年以前ぐらいまではtarballからインストールしていたと思うが、2020-04-26現在は、apt installが可能になっている。&lt;/p>
&lt;p>以下は最新版をインストールする手順:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">sudo add-apt-repository ppa:longsleep/golang-backports
sudo apt update
sudo apt install golang-go
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>A: Actions（タスク）</title><link>https://progrhy.me/tech-notes/a/web-service/github/action/action/</link><pubDate>Sun, 26 Apr 2020 14:28:26 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/web-service/github/action/action/</guid><description>
&lt;ul>
&lt;li>&lt;a href="https://github.com/marketplace?type=actions">Marketplace&lt;/a> &amp;hellip; 公開されているactionを見つけられる。&lt;/li>
&lt;/ul>
&lt;h2 id="actionとは">Actionとは&lt;/h2>
&lt;p>&lt;a href="https://help.github.com/en/actions/building-actions/about-actions#types-of-actions">About actions - GitHub Help&lt;/a>&lt;/p>
&lt;p>actionはワークフローで実行される処理（タスク）を再利用可能な形にパッケージしたものである。&lt;/p>
&lt;h3 id="actionの形式">Actionの形式&lt;/h3>
&lt;p>&lt;a href="https://help.github.com/en/actions/building-actions/about-actions#types-of-actions">https://help.github.com/en/actions/building-actions/about-actions#types-of-actions&lt;/a>&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Type&lt;/th>
&lt;th>Operating system&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Docker container&lt;/td>
&lt;td>Linux&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>JavaScript&lt;/td>
&lt;td>Linux, MacOS, Windows&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="ワークフローからの利用">ワークフローからの利用&lt;/h3>
&lt;p>&lt;a href="https://help.github.com/en/actions/configuring-and-managing-workflows/configuring-a-workflow#referencing-actions-in-your-workflow">https://help.github.com/en/actions/configuring-and-managing-workflows/configuring-a-workflow#referencing-actions-in-your-workflow&lt;/a>&lt;/p>
&lt;p>ワークフローからは、次のロケーションのactionが利用できる:&lt;/p>
&lt;ul>
&lt;li>公開リポジトリ&lt;/li>
&lt;li>同リポジトリ内で参照できるもの&lt;/li>
&lt;li>Docker Hubに公開されたDockerイメージ&lt;/li>
&lt;/ul>
&lt;h2 id="公式actions">公式Actions&lt;/h2>
&lt;p>GitHub公式のactionはたぶん &lt;a href="https://github.com/actions">https://github.com/actions&lt;/a> にあるもの。&lt;/p>
&lt;h3 id="checkout">checkout&lt;/h3>
&lt;p>&lt;a href="https://github.com/actions/checkout">https://github.com/actions/checkout&lt;/a>&lt;/p>
&lt;p>リポジトリをチェックアウトする。&lt;br>
おそらくほとんどのワークフローから利用される。&lt;/p>
&lt;p>Example:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-YAML" data-lang="YAML">- &lt;span style="color:#204a87;font-weight:bold">uses&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>actions/checkout@v2&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">with&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic"># Number of commits to fetch. 0 indicates all history.&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic"># Default: 1&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">fetch-depth&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic"># Whether to checkout submodules: `true` to checkout submodules or `recursive` to&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic"># recursively checkout submodules.&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic">#&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic"># Default: false&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">submodules&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">true&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="setup-node">setup-node&lt;/h3>
&lt;p>&lt;a href="https://github.com/actions/setup-node/">https://github.com/actions/setup-node/&lt;/a>&lt;/p>
&lt;p>Node.jsをセットアップ。&lt;/p>
&lt;p>Basic:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-YAML" data-lang="YAML">&lt;span style="color:#204a87;font-weight:bold">steps&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>- &lt;span style="color:#204a87;font-weight:bold">uses&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>actions/checkout@v2&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>- &lt;span style="color:#204a87;font-weight:bold">uses&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>actions/setup-node@v1&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">with&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">node-version&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#39;10.x&amp;#39;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>- &lt;span style="color:#204a87;font-weight:bold">run&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>npm&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>install&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>- &lt;span style="color:#204a87;font-weight:bold">run&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>npm&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>test&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Matrix Testing:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-YAML" data-lang="YAML">&lt;span style="color:#204a87;font-weight:bold">jobs&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">build&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">runs-on&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>ubuntu&lt;span style="color:#0000cf;font-weight:bold">-18.04&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">strategy&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">matrix&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">node&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#39;10.x&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#39;12.x&amp;#39;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>Node&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>${{&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>matrix.node&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>}}&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>sample&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">steps&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">uses&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>actions/checkout@v2&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>Setup&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>node&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">uses&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>actions/setup-node@v1&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">with&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">node-version&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>${{&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>matrix.node&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>}}&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">run&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>npm&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>install&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">run&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>npm&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>test&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://help.github.com/ja/actions/language-and-framework-guides/using-nodejs-with-github-actions">GitHub ActionsでのNode.jsの利用 - GitHub ヘルプ&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/actions/starter-workflows/blob/master/ci/node.js.yml">https://github.com/actions/starter-workflows/blob/master/ci/node.js.yml&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="3rd-party-actions">3rd Party Actions&lt;/h2>
&lt;h3 id="peaceirisactions-gh-pages">peaceiris/actions-gh-pages&lt;/h3>
&lt;p>&lt;a href="https://github.com/peaceiris/actions-gh-pages">https://github.com/peaceiris/actions-gh-pages&lt;/a>&lt;/p>
&lt;p>GitHub Pagesに公開するaction.&lt;/p>
&lt;p>Example:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-YAML" data-lang="YAML">- &lt;span style="color:#204a87;font-weight:bold">uses&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>peaceiris/actions-gh-pages@v3&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">with&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">github_token&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>${{&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>secrets.GITHUB_TOKEN&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>}}&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">publish_dir&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>./public&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic">#publish_branch: master # default: gh-pages&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="peaceirisactions-hugo">peaceiris/actions-hugo&lt;/h3>
&lt;p>&lt;a href="https://github.com/peaceiris/actions-hugo">https://github.com/peaceiris/actions-hugo&lt;/a>&lt;/p>
&lt;p>ランナー上にHugoをインストールする。&lt;/p>
&lt;p>Example:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-YAML" data-lang="YAML">- &lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>Setup&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>Hugo&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">uses&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>peaceiris/actions-hugo@v2&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">with&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">hugo-version&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#39;0.68.3&amp;#39;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic"># extended: true&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>- &lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>Build&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">run&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>hugo&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>--minify&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Tips:&lt;/p>
&lt;ul>
&lt;li>&lt;code>extended: true&lt;/code> でHugoの拡張版をインストール&lt;/li>
&lt;li>&lt;code>hugo-version: latest&lt;/code> で最新版を使う&lt;/li>
&lt;/ul></description></item><item><title>A: 言語仕様</title><link>https://progrhy.me/tech-notes/a/program/lang/go/spec/</link><pubDate>Sun, 26 Apr 2020 08:10:52 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/program/lang/go/spec/</guid><description>
&lt;p>リファレンス &lt;a href="https://golang.org/ref/spec">https://golang.org/ref/spec&lt;/a>&lt;/p>
&lt;h2 id="変数">変数&lt;/h2>
&lt;p>&lt;a href="https://golang.org/ref/spec#Variables">https://golang.org/ref/spec#Variables&lt;/a>&lt;/p>
&lt;h3 id="パッケージ変数">パッケージ変数&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#204a87;font-weight:bold">package&lt;/span> &lt;span style="color:#000">foo&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">var&lt;/span> &lt;span style="color:#000">privateVar&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;this is private&amp;#34;&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// 外部から見えない
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">var&lt;/span> &lt;span style="color:#000">PublicVar&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;this is public&amp;#34;&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// 外部から見える
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://d.hatena.ne.jp/ryochack/20120115/1326567659" title="Go言語のスコープについて - ryochack.clipboard">Go言語のスコープについて - ryochack.clipboard&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="データ型">データ型&lt;/h2>
&lt;p>&lt;a href="https://golang.org/ref/spec#Types">https://golang.org/ref/spec#Types&lt;/a>&lt;/p>
&lt;h3 id="配列スライス">配列・スライス&lt;/h3>
&lt;p>配列は固定長。スライスは可変長。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#000">a&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span>&lt;span style="color:#204a87;font-weight:bold">int&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">3&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// 配列
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>
&lt;span style="color:#000">s1&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000;font-weight:bold">[]&lt;/span>&lt;span style="color:#204a87;font-weight:bold">int&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">3&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// スライス
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#000">s2&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000;font-weight:bold">[]&lt;/span>&lt;span style="color:#204a87;font-weight:bold">int&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">5&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">6&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">7&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// スライスの結合
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#000">s1&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#204a87">append&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">s1&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">4&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">s1&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#204a87">append&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">s1&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">s2&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// スライス同士の結合では &amp;#34;...&amp;#34; が必要
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&amp;ldquo;Slicing&amp;quot;というテクニックで配列をスライスに変換できる。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#000">a&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">5&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span>&lt;span style="color:#204a87;font-weight:bold">byte&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;a&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;b&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;c&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;d&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;e&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;span style="color:#000">s&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">a&lt;/span>&lt;span style="color:#000;font-weight:bold">[:]&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// aを参照するスライス
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://blog.golang.org/go-slices-usage-and-internals" title="Go Slices: usage and internals - The Go Blog">Go Slices: usage and internals - The Go Blog&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://dibtp.hateblo.jp/entry/2014/07/06/190804" title="Go言語のArrayとSliceについて - done is better than perfect">Go言語のArrayとSliceについて - done is better than perfect&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://qiita.com/hash/items/eb7d780c57fe245a9ae7" title="Goでsliceに要素追加, slice同士の結合 - Qiita">Goでsliceに要素追加, slice同士の結合 - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="map">map&lt;/h3>
&lt;p>初期値はnilで、データを入れようとするとパニックが起こるので、事前に割当てが必要。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#8f5902;font-style:italic">// NG
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">var&lt;/span> &lt;span style="color:#000">ages&lt;/span> &lt;span style="color:#204a87;font-weight:bold">map&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span>&lt;span style="color:#204a87;font-weight:bold">int&lt;/span>
&lt;span style="color:#000">ages&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;carol&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">21&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// OK
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">var&lt;/span> &lt;span style="color:#000">ages&lt;/span> &lt;span style="color:#204a87;font-weight:bold">map&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span>&lt;span style="color:#204a87;font-weight:bold">int&lt;/span>
&lt;span style="color:#000">ages&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#204a87">make&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#204a87;font-weight:bold">map&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span>&lt;span style="color:#204a87;font-weight:bold">int&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">ages&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;carol&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">21&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// OK
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#000">ages&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#204a87">make&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#204a87;font-weight:bold">map&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span>&lt;span style="color:#204a87;font-weight:bold">int&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000">ages&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;carol&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">21&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="要素取得時のヒット検査">要素取得時のヒット検査&lt;/h4>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#000">age&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ok&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">ages&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;bob&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">ok&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// hit
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#204a87;font-weight:bold">else&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// miss
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="構造体">構造体&lt;/h3>
&lt;h4 id="初期化">初期化&lt;/h4>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#8f5902;font-style:italic">// 例
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">type&lt;/span> &lt;span style="color:#000">Foo&lt;/span> &lt;span style="color:#204a87;font-weight:bold">struct&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">Name&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span>
&lt;span style="color:#000">Age&lt;/span> &lt;span style="color:#204a87;font-weight:bold">int&lt;/span>
&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// (1)
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#000">f&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">Foo&lt;/span>&lt;span style="color:#000;font-weight:bold">{}&lt;/span>
&lt;span style="color:#000">f&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Name&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;foo&amp;#34;&lt;/span>
&lt;span style="color:#000">f&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Age&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">5&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// (2)
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#000">f&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">Foo&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;foo&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">5&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// 全てのフィールドの指定が必要
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// (3)
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#000">f&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">Foo&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#000">Age&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">5&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">Name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;foo&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// 任意フィールドの省略が可能。順番も入れ替え可能
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>もし構造体に初期値を設定したい場合、コンストラクタ的な専用の関数を作る必要があるっぽい。&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://qiita.com/cotrpepe/items/b8e7f70f27813a846431" title="[Go] 構造体の初期化方法まとめ - Qiita">[Go] 構造体の初期化方法まとめ - Qiita&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://gitpub.hatenablog.com/entry/2015/01/24/213223" title="【Go】structにデフォルトの値を設定したい - /dev/null">【Go】structにデフォルトの値を設定したい - /dev/null&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="日付時刻">日付・時刻&lt;/h2>
&lt;h3 id="日時フォーマット">日時フォーマット&lt;/h3>
&lt;p>Go言語の日時のフォーマット関数（timeパッケージの&lt;a href="https://golang.org/pkg/time/#Time.Format">func (Time) Format)&lt;/a>）に与えられる引数は、2006-01-02T15:04:05（月曜）の日時となっている。&lt;/p>
&lt;p>これはアメリカで時刻を表記する際の順番で、1月2日午後3時4分5秒2006年となり、わかりやすかったからだそうだ。&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://qiita.com/ruiu/items/5936b4c3bd6eb487c182">Goのtimeパッケージのリファレンスタイム（2006年1月2日）は何の日？ - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="ポインタ">ポインタ&lt;/h2>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://qiita.com/ruiu/items/e60aa707e16f8f6dccd8" title="Goでxxxのポインタを取っているプログラムはだいたい全部間違っている - Qiita">Goでxxxのポインタを取っているプログラムはだいたい全部間違っている - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="goroutine">goroutine&lt;/h2>
&lt;p>OSのネイティブスレッドより扱いやすくしたもの。
スレッドとファイバーの良いとこ取り。
&lt;code>go&lt;/code> というキーワードを付けるとgoroutineが作られる。&lt;/p>
&lt;p>Examples:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#8f5902;font-style:italic">// 別のgoroutineを作って既存関数を実行
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">go&lt;/span> &lt;span style="color:#000">Function&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// 別のgoroutineを作って、無名関数を実行
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">go&lt;/span> &lt;span style="color:#204a87;font-weight:bold">func&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// goroutine内で実行したい処理
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://qiita.com/najeira/items/47539ab346fa0c00dc62">Go言語で非同期処理の結果を受け取る - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="チャネル">チャネル&lt;/h2>
&lt;p>SYNOPSIS:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#8f5902;font-style:italic">// バッファなし
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#000">tasks&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#204a87">make&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#204a87;font-weight:bold">chan&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// バッファ付き
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#000">tasks&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#204a87">make&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#204a87;font-weight:bold">chan&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">10&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// データ送信
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#000">tasks&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;cmake ..&amp;#34;&lt;/span>
&lt;span style="color:#000">tasks&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;cmake . --build Debug&amp;#34;&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// データ受信
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#000">task&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span>&lt;span style="color:#000">tasks&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// データ受信 + クローズ判定
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#000">task&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ok&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span>&lt;span style="color:#000">tasks&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// データを読み捨てる
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span>&lt;span style="color:#000">wait&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Examples:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://gobyexample.com/channels">https://gobyexample.com/channels&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="select文">select文&lt;/h3>
&lt;p>複数のチャネルを待機する場合に使う。&lt;/p>
&lt;p>Examples:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#8f5902;font-style:italic">// ブロックせずに受信し、かつ、チャネルがクローズ済みかどうかチェックする
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">select&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">case&lt;/span> &lt;span style="color:#000">v&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ok&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span> &lt;span style="color:#000">ch&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">ok&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">fmt&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Println&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">v&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#204a87;font-weight:bold">else&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">fmt&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Println&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;closed&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">default&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;span style="color:#000">fmt&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Println&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;no value&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// ブロックせずに送信
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">select&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">case&lt;/span> &lt;span style="color:#000">ch&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span> &lt;span style="color:#000">v&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;span style="color:#000">fmt&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Println&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;sent&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">default&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;span style="color:#000">fmt&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Println&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;no capacity&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://qiita.com/najeira/items/71a0bcd079c9066347b4">Go言語でチャネルとselect - Qiita&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://cuto.unirita.co.jp/gostudy/post/go_select/">select - はじめてのGo言語&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="文法">文法&lt;/h2>
&lt;h3 id="ループ">ループ&lt;/h3>
&lt;p>Examples:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#204a87;font-weight:bold">for&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// 無限ループ
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">for&lt;/span> &lt;span style="color:#000">i&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span> &lt;span style="color:#000">i&lt;/span> &lt;span style="color:#000;font-weight:bold">&amp;lt;&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">100&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span> &lt;span style="color:#000">i&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">++&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// iが[1, 100)の間
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// collection要素のイテレーション
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#000">dayOfWeeks&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span>&lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;月&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;火&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;水&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;木&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;金&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;土&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;日&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">for&lt;/span> &lt;span style="color:#000">arrayIndex&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">dayOfWeek&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#204a87;font-weight:bold">range&lt;/span> &lt;span style="color:#000">dayOfWeeks&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">fmt&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Printf&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;%d番目の曜日は%s曜日です。\n&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">arrayIndex&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">dayOfWeek&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>※mapをイテレーションする場合、取り出し順はランダムになる。&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://cuto.unirita.co.jp/gostudy/post/loop-statement/">繰り返し - はじめてのGo言語&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="パッケージ">パッケージ&lt;/h2>
&lt;h3 id="init関数による初期化">init()関数による初期化&lt;/h3>
&lt;ul>
&lt;li>ソースファイルに1つ &lt;code>func init()&lt;/code> を記述できる&lt;/li>
&lt;li>ソースファイル読み込み時に1回実行される&lt;/li>
&lt;li>importされるpackageのinit()が先に実行される
&lt;ul>
&lt;li>pがqをimportしているとき、pのinit()より先にqのinit()が完了している&lt;/li>
&lt;li>mainパッケージのinit()が最後に実行される&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://golang.jp/tag/effective-go/page/2" title="Effective Go - golang.jp">Effective Go - golang.jp&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>A: Docsy</title><link>https://progrhy.me/tech-notes/a/software/static-site-generator/hugo/theme/docsy/</link><pubDate>Sun, 26 Apr 2020 00:27:11 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/software/static-site-generator/hugo/theme/docsy/</guid><description>
&lt;p>&lt;a href="https://www.docsy.dev/">https://www.docsy.dev/&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://mag.osdn.jp/19/07/11/162000">Googleが2019年に公開した&lt;/a>Hugoのテーマ。&lt;/p>
&lt;p>事例が&lt;a href="https://www.docsy.dev/docs/examples/">ここ&lt;/a>に載っている。&lt;br>
kubeflow, Knative, Apache Airflowなどで使われている。&lt;/p>
&lt;p>20ページ以上のドキュメントサイトを作るときに向いている、と謳っている。&lt;br>
多言語対応しており、プロダクトのバージョニングも考慮されている。&lt;/p>
&lt;h2 id="documentation">Documentation&lt;/h2>
&lt;p>&lt;a href="https://www.docsy.dev/docs/">https://www.docsy.dev/docs/&lt;/a>&lt;/p>
&lt;h2 id="getting-started">Getting Started&lt;/h2>
&lt;p>&lt;a href="https://www.docsy.dev/docs/getting-started/">https://www.docsy.dev/docs/getting-started/&lt;/a>&lt;/p>
&lt;p>&lt;strong>Hugoの拡張版&lt;/strong>が必要。&lt;br>
これはSCSSを使っているためのようだ。&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/google/docsy/issues/235">Error building site: POSTCSS: failed to transform &amp;quot;scss/main.css&amp;quot; · Issue #235 · google/docsy&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="デモサイトのソースをcloneして使う">デモサイトのソースをcloneして使う&lt;/h3>
&lt;p>ふつうのHugo Themeなら、 &lt;code>hugo new site&lt;/code> してconfig.tomlでthemeを指定すれば大体それっぽく動くのだけど、Docsyはやや作りが複雑なようなので、Exampleサイトのソースを再利用した方が早そう。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">git clone https://github.com/google/docsy-example.git mydocs
&lt;span style="color:#204a87">cd&lt;/span> mydocs
git submodule update --init --recursive
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>A: LEARN</title><link>https://progrhy.me/tech-notes/a/software/static-site-generator/hugo/theme/learn/</link><pubDate>Sat, 25 Apr 2020 23:43:30 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/software/static-site-generator/hugo/theme/learn/</guid><description>
&lt;p>&lt;a href="https://learn.netlify.com/en/">https://learn.netlify.com/en/&lt;/a>&lt;/p>
&lt;p>ドキュメンテーションに向いた高機能なHugoのテーマ。&lt;/p>
&lt;h2 id="コンテンツ管理">コンテンツ管理&lt;/h2>
&lt;h3 id="ページの追加">ページの追加&lt;/h3>
&lt;p>&lt;a href="https://themes.gohugo.io//theme/hugo-theme-learn/en/cont/archetypes/">https://themes.gohugo.io//theme/hugo-theme-learn/en/cont/archetypes/&lt;/a> を参照。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">&lt;span style="color:#8f5902;font-style:italic"># Chapterページ&lt;/span>
hugo new path/to/chapter/_index.md --kind chapter
&lt;span style="color:#8f5902;font-style:italic"># 普通のページ&lt;/span>
hugo new path/to/page.md
&lt;/code>&lt;/pre>&lt;/div>
&lt;div class="alert alert-primary" role="alert">
&lt;h4 class="alert-heading">NOTE&lt;/h4>
パスは &lt;code>content/&lt;/code> からの相対パス。
&lt;/div>
&lt;h2 id="拡張記法">拡張記法&lt;/h2>
&lt;p>いくつかHugoの機能を拡張して便利記法を提供してくれているのかな？&lt;/p>
&lt;p>&lt;a href="https://themes.gohugo.io//theme/hugo-theme-learn/en/shortcodes/">Shortcodes&lt;/a>に紹介されている。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://mermaid-js.github.io/mermaid/#/">Mermaid&lt;/a>によるフローチャート&lt;/li>
&lt;li>Hugoのサイト設定変数参照&lt;/li>
&lt;li>etc.&lt;/li>
&lt;/ul>
&lt;p>などの機能がある。&lt;/p>
&lt;p>以下は例:&lt;/p>
&lt;h3 id="注釈">注釈&lt;/h3>
&lt;pre>&lt;code>{{% notice note %}}
A notice disclaimer
{{% /notice %}}
&lt;/code>&lt;/pre>&lt;p>&lt;code>note&lt;/code> 以外に、 &lt;code>info&lt;/code>, &lt;code>tip&lt;/code>, &lt;code>warning&lt;/code> が使える。&lt;/p></description></item><item><title>A: 2020-04-25</title><link>https://progrhy.me/tech-notes/a/memo/20200425/</link><pubDate>Sat, 25 Apr 2020 23:20:56 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/memo/20200425/</guid><description>
&lt;h2 id="425">4/25&lt;/h2>
&lt;h3 id="技術メモ用のサイトをhugoで新設することにした">技術メモ用のサイトをHugoで新設することにした&lt;/h3>
&lt;p>&lt;a href="https://gsuiteupdates-ja.googleblog.com/2019/02/google-google.html">来年末には旧版のGoogleサイトが使えなくなるそう&lt;/a>なので、早く移行しないとなー、と前々から思っていた。
今回、ようやく重い腰を上げた形。&lt;/p>
&lt;p>今時はhugoで作ったGitHub PagesのサイトはGitHub Actionで自動更新できるようだ。&lt;/p>
&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://raahii.github.io/posts/automating-hugo-builds-with-github-actions/">HugoのビルドをGithub Actionで自動化する - 1ミリもわからん&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://qiita.com/peaceiris/items/d401f2e5724fdcb0759d">GitHub Actions による GitHub Pages への自動デプロイ - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>…で、前々から目をつけていたHugoのテーマ「&lt;a href="https://learn.netlify.com/en/">LEARN&lt;/a>」を使うことにした。&lt;/p>
&lt;p>Googleが去年公開した&lt;a href="https://www.docsy.dev/">Docsy&lt;/a>というテーマでもよさそうだと思ったけど、LEARNの方は一度軽く試したこともあったので、安心感があった。&lt;/p>
&lt;h3 id="learnで気に入らなかったところ">LEARNで気に入らなかったところ&lt;/h3>
&lt;p>少しHugoのLEARNテーマでサイトを作っていたのだけど、少し不満が出てきた。&lt;/p>
&lt;ul>
&lt;li>chapterページを作らないといけなくて、自由度が阻害されるように感じた。（自分でchapterページをカスタマイズするというやり方もあるが）&lt;/li>
&lt;li>検索が妙にヒットしすぎる&lt;/li>
&lt;li>ページの目次がちょっとわかりにくい。慣れれば問題ないけど&lt;/li>
&lt;/ul>
&lt;h3 id="gitbookを試してみたけどoss版は先行きが微妙">GitBookを試してみたけど、OSS版は先行きが微妙&lt;/h3>
&lt;p>GitBookでもいいんじゃないかと思って試していたのだけど、残念なことに気がついた。&lt;/p>
&lt;p>詳しくは&lt;a href="../../software/gitbook">Software &amp;gt; GitBook&lt;/a>に書いた。&lt;/p>
&lt;p>手順:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">npm install -g gitbook-cli
mkdir new-docs
&lt;span style="color:#204a87">cd&lt;/span> &lt;span style="color:#000">$_&lt;/span>
gitbook init
gitbook serve
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考にした記事:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://qiita.com/mebiusbox2/items/938af4b0d0bf7a4d3e33">GitBookによるドキュメント作成 - Qiita&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://morizyun.github.io/blog/gitbook-github-pages-deploy/index.html">GitBookをGitHub Pagesにアップロード | 酒と涙とRubyとRailsと&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://qiita.com/mitsuhisaT/items/8668b70586b9605040bd">gitbookの使い方 - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="結局docsyへ">結局、Docsyへ&lt;/h3>
&lt;p>&lt;a href="https://efcl.info/2017/12/26/docusaurus-almin/">azuさんがGitBookからDocusaurusに移行していた&lt;/a>ので、それもいいかもと思ったけど、見た目がDocsyに似ていたのでもうDocsyでいいだろうと思った。&lt;/p>
&lt;h2 id="426">4/26&lt;/h2>
&lt;h3 id="プロフィールサイトのgulpがつらい">プロフィールサイトのgulpがつらい&lt;/h3>
&lt;p>昨日、Docsyを扱うにあたって、UbuntuマシンのNode.jsをv8 -&amp;gt; v12に上げた。&lt;/p>
&lt;h4 id="referenceerror-primordials-is-not-defined">ReferenceError: primordials is not defined&lt;/h4>
&lt;p>今日、プロフィールサイト &lt;a href="https://progrhy.me">https://progrhy.me&lt;/a> の編集をしようとそのまま作業していたら、次とほぼ同じ問題に遭遇した。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://hepokon365.hatenablog.com/entry/2019/10/31/022524">Node.js v12にアップデートするとgulp v4でもfs.jsで「ReferenceError: primordials is not defined」エラーが発生 - 毎日へっぽこ&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>自分の環境で問題になったのは &lt;code>natives&lt;/code> module.&lt;/p>
&lt;pre>&lt;code>% gulp
fs.js:35
} = primordials;
^
ReferenceError: primordials is not defined
at fs.js:35:5
at req_ (/home/progrhyme/my/repos/progrhyme.github.io/node_modules/natives/index.js:137:5)
at Object.req [as require] (/home/progrhyme/my/repos/progrhyme.github.io/node_modules/natives/index.js:54:
10)
at Object.&amp;lt;anonymous&amp;gt; (/home/progrhyme/my/repos/progrhyme.github.io/node_modules/vinyl-fs/node_modules/gra
ceful-fs/fs.js:1:37)
at Module._compile (internal/modules/cjs/loader.js:1156:30) at Object.Module._extensions..js (internal/modules/cjs/loader.js:1176:10)
at Module.load (internal/modules/cjs/loader.js:1000:32)
at Function.Module._load (internal/modules/cjs/loader.js:899:14)
at Module.require (internal/modules/cjs/loader.js:1042:19)
at require (internal/modules/cjs/helpers.js:77:18)
&lt;/code>&lt;/pre>&lt;p>自分の場合も、上の記事と同じように、 &lt;code>package-lock.json&lt;/code> 内に &lt;code>graceful-fs&lt;/code> のv3系への依存があった。&lt;br>
また、依存の解消は難しいようだった。&lt;/p>
&lt;p>&lt;a href="https://sites.google.com/site/progrhymetechwiki/home/memo/20200424#TOC-Gulp-3---4-">前回の挑戦&lt;/a>から、gulpのバージョンアップは今のところ諦めているので、Node.jsのバージョンをv10系に下げることにした。&lt;/p>
&lt;h4 id="referenceerror-internalbinding-is-not-defined">ReferenceError: internalBinding is not defined&lt;/h4>
&lt;p>次に出くわしたのは下のエラー:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://narunaru7638.hatenablog.com/entry/2019/05/04/124621">gulp利用時に「ReferenceError: internalBinding is not defined」のエラー - なるの備忘録&lt;/a>&lt;/li>
&lt;/ul>
&lt;pre>&lt;code>% gulp
internal/util/inspect.js:31
const types = internalBinding('types');
^
ReferenceError: internalBinding is not defined
at internal/util/inspect.js:31:15
at req_ (/home/progrhyme/my/repos/progrhyme.github.io/node_modules/natives/index.js:137:5)
at require (/home/progrhyme/my/repos/progrhyme.github.io/node_modules/natives/index.js:110:12)
at util.js:25:21
at req_ (/home/progrhyme/my/repos/progrhyme.github.io/node_modules/natives/index.js:137:5)
at require (/home/progrhyme/my/repos/progrhyme.github.io/node_modules/natives/index.js:110:12)
at fs.js:42:21
at req_ (/home/progrhyme/my/repos/progrhyme.github.io/node_modules/natives/index.js:137:5)
at Object.req [as require] (/home/progrhyme/my/repos/progrhyme.github.io/node_modules/natives/index.js:54:
10)
at Object.&amp;lt;anonymous&amp;gt; (/home/progrhyme/my/repos/progrhyme.github.io/node_modules/vinyl-fs/node_modules/gra
ceful-fs/fs.js:1:37)
&lt;/code>&lt;/pre>&lt;p>上の記事にあったように、 &lt;code>npm i natives@latest --no-save&lt;/code> を実行したら解消した。&lt;/p></description></item></channel></rss>