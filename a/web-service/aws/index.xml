<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>progrhyme's Tech Notes – Amazon Web Service</title><link>https://progrhy.me/tech-notes/a/web-service/aws/</link><description>Recent content in Amazon Web Service on progrhyme's Tech Notes</description><generator>Hugo -- gohugo.io</generator><language>ja</language><lastBuildDate>Wed, 03 Jun 2020 13:41:40 +0900</lastBuildDate><atom:link href="https://progrhy.me/tech-notes/a/web-service/aws/index.xml" rel="self" type="application/rss+xml"/><item><title>A: AWS CLI</title><link>https://progrhy.me/tech-notes/a/web-service/aws/cli/</link><pubDate>Wed, 03 Jun 2020 13:41:48 +0900</pubDate><guid>https://progrhy.me/tech-notes/a/web-service/aws/cli/</guid><description>
&lt;h2 id="about">About&lt;/h2>
&lt;p>&lt;a href="https://github.com/aws/aws-cli">https://github.com/aws/aws-cli&lt;/a>&lt;/p>
&lt;p>NOTE:&lt;/p>
&lt;ul>
&lt;li>2020-02-12 AWS CLI v2が一般利用可能になった。
&lt;ul>
&lt;li>&lt;a href="https://aws.amazon.com/jp/blogs/news/aws-cli-v2-is-now-generally-available/">AWS CLI v2 が一般利用可能となりました | Amazon Web Services ブログ&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="install">Install&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="http://docs.aws.amazon.com/ja_jp/cli/latest/userguide/installing.html" title="AWS Command Line Interface のインストール - AWS Command Line Interface">AWS Command Line Interface のインストール - AWS Command Line Interface&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="macos">macOS&lt;/h3>
&lt;ul>
&lt;li>公式ガイド: &lt;a href="https://docs.aws.amazon.com/ja_jp/cli/latest/userguide/install-cliv2-mac.html">macOS での AWS CLI バージョン 2 のインストール - AWS Command Line Interface&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>※2020-06-03 Homebrewでv2が入るが、なぜかpythonに依存している。&lt;br>
&lt;a href="https://formulae.brew.sh/formula/awscli">https://formulae.brew.sh/formula/awscli&lt;/a>&lt;/p>
&lt;h2 id="dockerイメージ">Dockerイメージ&lt;/h2>
&lt;p>※過去の記述である&lt;/p>
&lt;p>&lt;a href="https://hub.docker.com/r/mesosphere/aws-cli/">https://hub.docker.com/r/mesosphere/aws-cli/&lt;/a> がちゃんとしてそう。&lt;/p>
&lt;h2 id="reference">Reference&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/index.html">aws — AWS CLI 2 Command Reference&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.aws.amazon.com/cli/latest/reference/">aws — AWS CLI 1 Command Reference&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>※以下、古いWikiの内容をマイグレートしたので、v1の情報が元になっているものが多い。&lt;/p>
&lt;h3 id="configure">configure&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># credential等がちゃんと設定されてるか確認&lt;/span>
aws configure list
&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://aws.amazon.com/jp/premiumsupport/knowledge-center/s3-locate-credentials-error/">S3 バケットの「認証情報が見つかりません」エラーを修正する&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="logs">logs&lt;/h3>
&lt;p>&lt;a href="http://docs.aws.amazon.com/cli/latest/reference/logs/index.html">http://docs.aws.amazon.com/cli/latest/reference/logs/index.html&lt;/a>&lt;/p>
&lt;p>CloudWatch Logs.&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://docs.aws.amazon.com/cli/latest/reference/logs/get-log-events.html">http://docs.aws.amazon.com/cli/latest/reference/logs/get-log-events.html&lt;/a>
&lt;ul>
&lt;li>&lt;code>--start-time&lt;/code>, &lt;code>--end-time&lt;/code> の引数はミリ秒単位のunixtime&lt;/li>
&lt;li>&lt;code>--limit&lt;/code> は10000が上限で、より大きな値を指定するとバリデーションエラーになる。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>Examples:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">&lt;span style="color:#8f5902;font-style:italic"># 2017/12/20 8:50 - 9:10のログを取得&lt;/span>
$ date +%s -d &lt;span style="color:#4e9a06">&amp;#34;2017-12-20 08:50:00&amp;#34;&lt;/span>
&lt;span style="color:#0000cf;font-weight:bold">1513727400&lt;/span>
$ date +%s -d &lt;span style="color:#4e9a06">&amp;#34;2017-12-20 09:10:00&amp;#34;&lt;/span>
&lt;span style="color:#0000cf;font-weight:bold">1513728600&lt;/span>
$ aws logs get-log-events &lt;span style="color:#4e9a06">\
&lt;/span>&lt;span style="color:#4e9a06">&lt;/span> --log-group-name &amp;lt;your-log-group&amp;gt; --log-stream-name &amp;lt;your-log-stream&amp;gt; &lt;span style="color:#4e9a06">\
&lt;/span>&lt;span style="color:#4e9a06">&lt;/span> --start-time &lt;span style="color:#0000cf;font-weight:bold">1513727400000&lt;/span> --end-time &lt;span style="color:#0000cf;font-weight:bold">1513728600000&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="sns">sns&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://docs.aws.amazon.com/cli/latest/reference/sns/">https://docs.aws.amazon.com/cli/latest/reference/sns/&lt;/a>
&lt;ul>
&lt;li>&lt;a href="https://docs.aws.amazon.com/cli/latest/reference/sns/publish.html">https://docs.aws.amazon.com/cli/latest/reference/sns/publish.html&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>Examples:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">&lt;span style="color:#8f5902;font-style:italic"># テキストファイルの内容を送信&lt;/span>
aws sns publish --topic-arn &lt;span style="color:#4e9a06">&amp;#34;arn:aws:sns:ap-northeast-1:&lt;/span>&lt;span style="color:#4e9a06">${&lt;/span>&lt;span style="color:#000">AWS_ACCOUNT_ID&lt;/span>&lt;span style="color:#4e9a06">}&lt;/span>&lt;span style="color:#4e9a06">:&lt;/span>&lt;span style="color:#4e9a06">${&lt;/span>&lt;span style="color:#000">topic&lt;/span>&lt;span style="color:#4e9a06">}&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;&lt;/span> --subject &lt;span style="color:#4e9a06">&amp;#34;my sns notification&amp;#34;&lt;/span> --message file://path/to/message-file
&lt;span style="color:#8f5902;font-style:italic"># コマンドの実行結果を送信&lt;/span>
aws sns publish --topic-arn &lt;span style="color:#4e9a06">&amp;#34;arn:aws:sns:ap-northeast-1:&lt;/span>&lt;span style="color:#4e9a06">${&lt;/span>&lt;span style="color:#000">AWS_ACCOUNT_ID&lt;/span>&lt;span style="color:#4e9a06">}&lt;/span>&lt;span style="color:#4e9a06">:&lt;/span>&lt;span style="color:#4e9a06">${&lt;/span>&lt;span style="color:#000">topic&lt;/span>&lt;span style="color:#4e9a06">}&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;&lt;/span> --message &lt;span style="color:#4e9a06">&amp;#34;&lt;/span>&lt;span style="color:#204a87;font-weight:bold">$(&lt;/span>cat path/to/file&lt;span style="color:#204a87;font-weight:bold">)&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="ssm">ssm&lt;/h3>
&lt;p>&lt;a href="http://docs.aws.amazon.com/cli/latest/reference/ssm/index.html">http://docs.aws.amazon.com/cli/latest/reference/ssm/index.html&lt;/a>&lt;/p>
&lt;p>Parameter Store:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://docs.aws.amazon.com/cli/latest/reference/ssm/get-parameter.html">http://docs.aws.amazon.com/cli/latest/reference/ssm/get-parameter.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://docs.aws.amazon.com/cli/latest/reference/ssm/get-parameters.html">http://docs.aws.amazon.com/cli/latest/reference/ssm/get-parameters.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://docs.aws.amazon.com/cli/latest/reference/ssm/put-parameter.html">http://docs.aws.amazon.com/cli/latest/reference/ssm/put-parameter.html&lt;/a>&lt;/li>
&lt;/ul></description></item></channel></rss>