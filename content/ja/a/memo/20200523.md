---
title: "2020-05-23"
linkTitle: "2020-05-23"
date: 2020-05-23T16:42:12+09:00
---

## 5/23
### gcloud-promptにテストとCIを足した

https://github.com/progrhyme/gcloud-prompt/pull/1

複数のシェルから同時に触っても表示が壊れたりしないように、排他制御機構を入れたのだけど、逆にエンバグしそうで怖くなったので、テストを足した。

テストのため、 `gcloud` コマンドの挙動をなんちゃって実装したシェルスクリプトを書いたけど、これはスタブなのだろうか、モックなのだろうかというのが気になった。  
とりあえずコメントでは「stub」ということにしておいたけど。

See [Software > テスト#スタブとモックの違い]({{<ref "/a/software/test.md">}}#スタブとモックの違い)

今回実装した機能を鑑みるに、

- `gcloud info` や `gcloud config` が呼ばれたときに決まった結果を返す -> スタブ
- gcloud-prompt.shから `gcloud config` コマンドが呼ばれたときに、呼ばれた回数を記録 -> モック

両方の性質を合わせ持ってることになるのかな？

詳しい人いたら教えてほしい。
